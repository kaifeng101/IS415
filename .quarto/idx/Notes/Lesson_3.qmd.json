{"title":"Notes 3","markdown":{"yaml":{"title":"Notes 3","subtitle":"Spatial Point Patterns Analysis","author":"Kai Feng","date":"Sept 2, 2024","date-modified":"last-modified","execute":{"eval":true,"echo":true,"freeze":true}},"headingText":"Purpose of Geospatial Analytics","containsRefs":false,"markdown":"\n\n\n\n-   So that we can quantitatively derive it (eg. using KDE).\n\n-   Uses data related to locations to find patterns & trends\n\n# Spatial Point Patterns\n\n-   To study how points (Event) are spread out over an area\n\n-   **Only map Events, no 'Non-Event'**\n\n-   The mapped pattern should not be:\n\n    -   selection bias\n\n    -   Not a sample (eg. It is ok to take aged 70-80 from the population. But **do not do random sampling out of this group**)\n\nExample:\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-1.jpg){width=\"344\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-3.jpg){width=\"295\"}\n\n# Real-world spatial point patterns -Random OR Patterned?\n\n-   hard to have random distribution\n\n    -   eg. Some areas like the airport will never have childcare\n\n    -   We can use **2nd Order Spatial Point Pattern Analysis** to prove\n\n-   hard to find something uniform in real world\n\n    -   eg. For instance a desert, if you zoom out a bit, there could be small hills, different land. It would not be the same across such as flat land\n\n-   Before performing any spatial analysis, **exclude areas that is definitely dont have the occurence. \\[Else, when generate the spatial random data, you might have childcare center there\\]**\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-7.jpg){width=\"250\"}\n\n# Spatial Point Patterns Analysis\n\n-   usually in 2D space\n\n-   set X = {x ∈ D}, **D = study region**, **subset of Rn, a** n-dimensional **Euclidean space**\n\n-   Issue: We need infer if the given is **merely random** or result of some process:\n\n    -   ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-9.jpg){width=\"402\"}\n\n### 1st-order VS 2nd-order Analysis\n\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n|           | 1st Order                                                                                                                                                                                 | 2nd Order                                                                                                  |\n+===========+===========================================================================================================================================================================================+============================================================================================================+\n|           | -   focuses on the overall **intensity** or **density** of events across a study area.                                                                                                    | -   examines the **interaction** or **relationships** between points within a study area.                  |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | examines how the number of points (events) changes over space, often influenced by external factors such as environmental conditions, socioeconomic factors, or other large-scale trends. | -   help to identify whether points tend to cluster, repel, or distribute randomly relative to each other. |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | Example:                                                                                                                                                                                  | Example:                                                                                                   |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | \"Where are the points more or less dense?\"                                                                                                                                                | \"Are the points clustered, dispersed, or randomly distributed in relation to each other?\"                  |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | \"How does the density of events vary across the study area?                                                                                                                               | \"How does the pattern change with distance?\"                                                               |\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n| Technique | **Density-based:**                                                                                                                                                                        | -   G function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   KDE (Kernel density estimation)                                                                                                                                                       | -   F function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   Quadrat analysis                                                                                                                                                                      | -   K function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | **Distance-based:**                                                                                                                                                                       | -   L function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   Nearest Neighbour Index                                                                                                                                                               |                                                                                                            |\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n\n# 1st-order\\[Kernel Density Estimation (KDE)\\]\n\n-   used to estimate the probability density function of a random variable.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-20.jpg){width=\"358\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-20b.png){width=\"311\"}\n\n### Steps in KDE\n\n1.  Place a Kernel on Each Point (event location)\n    -   The height and shape of this bump depend on the chosen kernel function and the bandwidth.\n2.  Sum the Kernels\n    -   For each point in the study area, the contribution of all surrounding kernels is summed to calculate the density value at that point.\n3.  Create a Continuous Surface\n    -   The result is a smooth surface where higher values indicate areas with higher event densities, and lower values indicate areas with fewer events.\n\n### KDE Methods\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-22.jpg){width=\"371\"}\n\n1.  **Uniform** -\\> intensity will not change during this period, immediately after, it will be 0\n\n2.  **Triangular** -\\> move away from center point, it will decrease very fast from the center point\n\n3.  **Quartic & Gaussian** -\\>\n\n    -   not identical, but similar. If get negative value from Gaussian, can switch to Quartic.\n\n    -   **Gaussian** is very common (**Gives more weight to points closer to the event & less weight to points farther away)**\n\n    -   Try different option, select the appropriate one & explain why\n\n### KDE Bandwidth\n\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n| **Fixed Bandwidth -determine distance for you**                                                                                   | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-23.jpg){width=\"307\"} |\n|                                                                                                                                   |                                                                                           |\n| -   Define a fixed distance -\\> use this distance throughout the study                                                            |                                                                                           |\n|                                                                                                                                   |                                                                                           |\n| -   In extreme case, might not able to calibrate in local areas where data are too sparse to satisfy the calibration requirements |                                                                                           |\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n| -   **Adaptive Bandwidth -determine the k for you**                                                                               | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-24.jpg)              |\n|                                                                                                                                   |                                                                                           |\n|     -   Fixed the no. of spatial points                                                                                           |                                                                                           |\n|                                                                                                                                   |                                                                                           |\n|     -   eg. I will search for 8 childcare center no matter the length                                                             |                                                                                           |\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n\n**\\* Small bandwidth = highly localized estimate, showing fine details (but could miss broader patterns)**\n\n**\\* Large bandwidth = smooth out the estimart (possibly oversimplifying the data)**\n\n\\* **Automatic bandwidth -\\> bw.diggle()**\n\n![](images/clipboard-2183884731.png)\n\n# 1st-order \\[Quadrat Analysis\\]\n\n### Steps\n\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 1.  Divide the study area into subregion of equal size,    | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-12.jpg) |\n|                                                            |                                                                              |\n|     -   often squares, but don’t have to be.               |                                                                              |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 2.  Count the frequency of events in each region.          | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-13.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 3.  Calculate the intensity of events in each region.      | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-14.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 4.  Calculate the quadrat statistics and perform CSR test. | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-15.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n\n**Uniform distribution** -\\> variance-mean ratio = 0\n\n**Random distribution** -\\> variance-mean ratio **close to 1**\n\n**Cluster distribution** -\\> variance-mean ratio **greater than 1**\n\n### Interpretation\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-17.jpg){width=\"410\"}\n\n### Weaknesses\n\n-   sensitive to the quadrat size\n\n    -   If too small, they may contain only a couple of points, and\n\n    -   If too large, they may contain too many points.\n\n-   It is a measure of **dispersion** rather than a measure of **pattern**.\n\n<!-- -->\n\n-   It results in a single measure for the entire distribution, so variation within the region are not recognised.\n\n# Complete Spatial Randomness CSR\n\n-   satisfy 2 conditions\n\n    -   any event has equal probability of being in any location, a **1st order** effect\n\n    -   The location of one event is independent of the location of another event, a **2nd order** effect.\n\n# 1st-order \\[**Distance-based:** Nearest Neighbour Index\\]\n\n-   Direct distance from a point to its nearest neighbour\n\n-   Index \\< 1: clustering\n\n-   Index = 1: random\n\n-   Index \\> 1: dispersion\n\n    ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-28.jpg)\n\nExample:\n\n![](images/clipboard-3457834433.png){width=\"425\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-30.jpg){width=\"438\"}\n\n**p-value is \\< 0.05, so reject null hypo that the point patterns are randomly distributed**\n\n# 2nd-order \\[G function\\]\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-32.jpg){width=\"230\"}\n\n-   within this radius, how many childcare i found\n\n-   Within 0-9, what is the intensity\n\n-   **Clustered**: If G increases rapidly at short distance\n\n-   **Evenness**: If G increases slowly up to distance where most events spaced, then increases rapidly\n\n### Monte Carlo simulation test of CSR\n\n![](images/clipboard-3416485639.png)\n\n-   nsim = 999 **\\<- Performed 999 simulations \\[Cannot do 1 only, the more = more stable, result will converge\\]**\n\n-   for each simulated point pattern, estimate G(r) & use the max 95th and min 5th of these functions for the simulated patterns to define an upper and lower simulation envelope.\n\n-   **Estimate G(r) is statistically significant** if estimated G(r) lies above the upper envelope or below the lower envelope\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-35.jpg){width=\"365\"}\n\n# 2nd-order \\[F function\\]\n\n-   Select a sample of point locations anywhere in the study region at random\n\n    -   Determine min distance from each point to any event in the study area.\n\n    ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-36.jpg){width=\"527\"}\n\n-   **Clustered** = F(r) rises slowly at first, but more rapidly at longer distances.\n\n```{=html}\n<!-- -->\n```\n-   **Evenness** = F(r) rises rapidly at first, then slowly at longer distances.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-37.jpg){width=\"521\"}\n\n# Comparison between F and G function\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-38.jpg)\n\n# 2nd-order \\[K function\\]\n\n-   Limitation of nearest neighbor distance method is that it uses only nearest distance\n\n-   Considers only the shortest scales of variation.\n\n-   K function uses more points.\n\n    -   Provides an estimate of spatial dependence over a wider range of scales.\n\n    -   Based on all the distances between events in the study area.\n\n    -   Assumes isotropy over the region.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-39.jpg){width=\"343\"}\n\n### Calculating K function\n\n-   Construct a circle of radius h around each point event(i).\n\n-   Count the number of other events (j) that fall inside this circle.\n\n-   Repeat these two steps for all points (i) and sum results.\n\n-   Increment h by a small amount and repeat the calculation.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-42.jpg){width=\"446\"}\n\nSignificant **cluster** pattern -\\> above envelop\n\nSignificant **regular** pattern -\\> below envelop\n\n**CSR** -\\> inside envelop\n\n# 2nd-order \\[L function\\]\n\n-   K function will be normalised to obtained a benchmark of zero.\n\n```{=html}\n<!-- -->\n```\n-   When an observed L value is greater than its corresponding L(theo)(i.e. red break line) value for a particular distance and above the upper confidence envelop, spatial clustering for that distance is statistically significant (e.g. distance beyond C).\n\n-   When an observed L value is greater than its corresponding L(theo) value for a particular distance and lower than the upper confidence envelop, spatial clustering for that distance is statistically NOT significant (e.g. distance between B and C).\n\n-   When an observed L value is smaller than its corresponding L(theo) value for a particular distance and beyond the lower confidence envelop, spatial dispersion for that distance is statistically significant. - When an observed L value is smaller than its corresponding L(theo) value for a particular distance and within the lower confidence envelop, spatial dispersion for that distance is statistically NOT significant (e.g. distance between A and B).\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-44.jpg){width=\"393\"}\n\n-   L(r)\\>0 indicates that the observed distribution is geographically concentrated.\n\n-   L(r)\\<0 implies dispersion.\n\n-   L(r)=0 indicates complete spatial randomness (CRS).\n\n\\* Anything outside of envelop, you will have enough statistical evidence, if inside means you still fall into the confidence lvl (cannot reject null, cause not enough evidence to infer)\n\n# set.seed()\n\n-   to produce reproducible result\n\n-   result from algo might change every run, use this to fix it\n","srcMarkdownNoYaml":"\n\n# \n\n# Purpose of Geospatial Analytics\n\n-   So that we can quantitatively derive it (eg. using KDE).\n\n-   Uses data related to locations to find patterns & trends\n\n# Spatial Point Patterns\n\n-   To study how points (Event) are spread out over an area\n\n-   **Only map Events, no 'Non-Event'**\n\n-   The mapped pattern should not be:\n\n    -   selection bias\n\n    -   Not a sample (eg. It is ok to take aged 70-80 from the population. But **do not do random sampling out of this group**)\n\nExample:\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-1.jpg){width=\"344\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-3.jpg){width=\"295\"}\n\n# Real-world spatial point patterns -Random OR Patterned?\n\n-   hard to have random distribution\n\n    -   eg. Some areas like the airport will never have childcare\n\n    -   We can use **2nd Order Spatial Point Pattern Analysis** to prove\n\n-   hard to find something uniform in real world\n\n    -   eg. For instance a desert, if you zoom out a bit, there could be small hills, different land. It would not be the same across such as flat land\n\n-   Before performing any spatial analysis, **exclude areas that is definitely dont have the occurence. \\[Else, when generate the spatial random data, you might have childcare center there\\]**\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-7.jpg){width=\"250\"}\n\n# Spatial Point Patterns Analysis\n\n-   usually in 2D space\n\n-   set X = {x ∈ D}, **D = study region**, **subset of Rn, a** n-dimensional **Euclidean space**\n\n-   Issue: We need infer if the given is **merely random** or result of some process:\n\n    -   ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-9.jpg){width=\"402\"}\n\n### 1st-order VS 2nd-order Analysis\n\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n|           | 1st Order                                                                                                                                                                                 | 2nd Order                                                                                                  |\n+===========+===========================================================================================================================================================================================+============================================================================================================+\n|           | -   focuses on the overall **intensity** or **density** of events across a study area.                                                                                                    | -   examines the **interaction** or **relationships** between points within a study area.                  |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | examines how the number of points (events) changes over space, often influenced by external factors such as environmental conditions, socioeconomic factors, or other large-scale trends. | -   help to identify whether points tend to cluster, repel, or distribute randomly relative to each other. |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | Example:                                                                                                                                                                                  | Example:                                                                                                   |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | \"Where are the points more or less dense?\"                                                                                                                                                | \"Are the points clustered, dispersed, or randomly distributed in relation to each other?\"                  |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | \"How does the density of events vary across the study area?                                                                                                                               | \"How does the pattern change with distance?\"                                                               |\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n| Technique | **Density-based:**                                                                                                                                                                        | -   G function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   KDE (Kernel density estimation)                                                                                                                                                       | -   F function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   Quadrat analysis                                                                                                                                                                      | -   K function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | **Distance-based:**                                                                                                                                                                       | -   L function                                                                                             |\n|           |                                                                                                                                                                                           |                                                                                                            |\n|           | -   Nearest Neighbour Index                                                                                                                                                               |                                                                                                            |\n+-----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+\n\n# 1st-order\\[Kernel Density Estimation (KDE)\\]\n\n-   used to estimate the probability density function of a random variable.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-20.jpg){width=\"358\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-20b.png){width=\"311\"}\n\n### Steps in KDE\n\n1.  Place a Kernel on Each Point (event location)\n    -   The height and shape of this bump depend on the chosen kernel function and the bandwidth.\n2.  Sum the Kernels\n    -   For each point in the study area, the contribution of all surrounding kernels is summed to calculate the density value at that point.\n3.  Create a Continuous Surface\n    -   The result is a smooth surface where higher values indicate areas with higher event densities, and lower values indicate areas with fewer events.\n\n### KDE Methods\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-22.jpg){width=\"371\"}\n\n1.  **Uniform** -\\> intensity will not change during this period, immediately after, it will be 0\n\n2.  **Triangular** -\\> move away from center point, it will decrease very fast from the center point\n\n3.  **Quartic & Gaussian** -\\>\n\n    -   not identical, but similar. If get negative value from Gaussian, can switch to Quartic.\n\n    -   **Gaussian** is very common (**Gives more weight to points closer to the event & less weight to points farther away)**\n\n    -   Try different option, select the appropriate one & explain why\n\n### KDE Bandwidth\n\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n| **Fixed Bandwidth -determine distance for you**                                                                                   | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-23.jpg){width=\"307\"} |\n|                                                                                                                                   |                                                                                           |\n| -   Define a fixed distance -\\> use this distance throughout the study                                                            |                                                                                           |\n|                                                                                                                                   |                                                                                           |\n| -   In extreme case, might not able to calibrate in local areas where data are too sparse to satisfy the calibration requirements |                                                                                           |\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n| -   **Adaptive Bandwidth -determine the k for you**                                                                               | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-24.jpg)              |\n|                                                                                                                                   |                                                                                           |\n|     -   Fixed the no. of spatial points                                                                                           |                                                                                           |\n|                                                                                                                                   |                                                                                           |\n|     -   eg. I will search for 8 childcare center no matter the length                                                             |                                                                                           |\n+-----------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+\n\n**\\* Small bandwidth = highly localized estimate, showing fine details (but could miss broader patterns)**\n\n**\\* Large bandwidth = smooth out the estimart (possibly oversimplifying the data)**\n\n\\* **Automatic bandwidth -\\> bw.diggle()**\n\n![](images/clipboard-2183884731.png)\n\n# 1st-order \\[Quadrat Analysis\\]\n\n### Steps\n\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 1.  Divide the study area into subregion of equal size,    | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-12.jpg) |\n|                                                            |                                                                              |\n|     -   often squares, but don’t have to be.               |                                                                              |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 2.  Count the frequency of events in each region.          | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-13.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 3.  Calculate the intensity of events in each region.      | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-14.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n| 4.  Calculate the quadrat statistics and perform CSR test. | ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-15.jpg) |\n+------------------------------------------------------------+------------------------------------------------------------------------------+\n\n**Uniform distribution** -\\> variance-mean ratio = 0\n\n**Random distribution** -\\> variance-mean ratio **close to 1**\n\n**Cluster distribution** -\\> variance-mean ratio **greater than 1**\n\n### Interpretation\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-17.jpg){width=\"410\"}\n\n### Weaknesses\n\n-   sensitive to the quadrat size\n\n    -   If too small, they may contain only a couple of points, and\n\n    -   If too large, they may contain too many points.\n\n-   It is a measure of **dispersion** rather than a measure of **pattern**.\n\n<!-- -->\n\n-   It results in a single measure for the entire distribution, so variation within the region are not recognised.\n\n# Complete Spatial Randomness CSR\n\n-   satisfy 2 conditions\n\n    -   any event has equal probability of being in any location, a **1st order** effect\n\n    -   The location of one event is independent of the location of another event, a **2nd order** effect.\n\n# 1st-order \\[**Distance-based:** Nearest Neighbour Index\\]\n\n-   Direct distance from a point to its nearest neighbour\n\n-   Index \\< 1: clustering\n\n-   Index = 1: random\n\n-   Index \\> 1: dispersion\n\n    ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-28.jpg)\n\nExample:\n\n![](images/clipboard-3457834433.png){width=\"425\"}\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-30.jpg){width=\"438\"}\n\n**p-value is \\< 0.05, so reject null hypo that the point patterns are randomly distributed**\n\n# 2nd-order \\[G function\\]\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-32.jpg){width=\"230\"}\n\n-   within this radius, how many childcare i found\n\n-   Within 0-9, what is the intensity\n\n-   **Clustered**: If G increases rapidly at short distance\n\n-   **Evenness**: If G increases slowly up to distance where most events spaced, then increases rapidly\n\n### Monte Carlo simulation test of CSR\n\n![](images/clipboard-3416485639.png)\n\n-   nsim = 999 **\\<- Performed 999 simulations \\[Cannot do 1 only, the more = more stable, result will converge\\]**\n\n-   for each simulated point pattern, estimate G(r) & use the max 95th and min 5th of these functions for the simulated patterns to define an upper and lower simulation envelope.\n\n-   **Estimate G(r) is statistically significant** if estimated G(r) lies above the upper envelope or below the lower envelope\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-35.jpg){width=\"365\"}\n\n# 2nd-order \\[F function\\]\n\n-   Select a sample of point locations anywhere in the study region at random\n\n    -   Determine min distance from each point to any event in the study area.\n\n    ![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-36.jpg){width=\"527\"}\n\n-   **Clustered** = F(r) rises slowly at first, but more rapidly at longer distances.\n\n```{=html}\n<!-- -->\n```\n-   **Evenness** = F(r) rises rapidly at first, then slowly at longer distances.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-37.jpg){width=\"521\"}\n\n# Comparison between F and G function\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-38.jpg)\n\n# 2nd-order \\[K function\\]\n\n-   Limitation of nearest neighbor distance method is that it uses only nearest distance\n\n-   Considers only the shortest scales of variation.\n\n-   K function uses more points.\n\n    -   Provides an estimate of spatial dependence over a wider range of scales.\n\n    -   Based on all the distances between events in the study area.\n\n    -   Assumes isotropy over the region.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-39.jpg){width=\"343\"}\n\n### Calculating K function\n\n-   Construct a circle of radius h around each point event(i).\n\n-   Count the number of other events (j) that fall inside this circle.\n\n-   Repeat these two steps for all points (i) and sum results.\n\n-   Increment h by a small amount and repeat the calculation.\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-42.jpg){width=\"446\"}\n\nSignificant **cluster** pattern -\\> above envelop\n\nSignificant **regular** pattern -\\> below envelop\n\n**CSR** -\\> inside envelop\n\n# 2nd-order \\[L function\\]\n\n-   K function will be normalised to obtained a benchmark of zero.\n\n```{=html}\n<!-- -->\n```\n-   When an observed L value is greater than its corresponding L(theo)(i.e. red break line) value for a particular distance and above the upper confidence envelop, spatial clustering for that distance is statistically significant (e.g. distance beyond C).\n\n-   When an observed L value is greater than its corresponding L(theo) value for a particular distance and lower than the upper confidence envelop, spatial clustering for that distance is statistically NOT significant (e.g. distance between B and C).\n\n-   When an observed L value is smaller than its corresponding L(theo) value for a particular distance and beyond the lower confidence envelop, spatial dispersion for that distance is statistically significant. - When an observed L value is smaller than its corresponding L(theo) value for a particular distance and within the lower confidence envelop, spatial dispersion for that distance is statistically NOT significant (e.g. distance between A and B).\n\n![](https://is415-ay2024-25t1.netlify.app/lesson/lesson03/img/image4-44.jpg){width=\"393\"}\n\n-   L(r)\\>0 indicates that the observed distribution is geographically concentrated.\n\n-   L(r)\\<0 implies dispersion.\n\n-   L(r)=0 indicates complete spatial randomness (CRS).\n\n\\* Anything outside of envelop, you will have enough statistical evidence, if inside means you still fall into the confidence lvl (cannot reject null, cause not enough evidence to infer)\n\n# set.seed()\n\n-   to produce reproducible result\n\n-   result from algo might change every run, use this to fix it\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"Lesson_3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"cosmo","title":"Notes 3","subtitle":"Spatial Point Patterns Analysis","author":"Kai Feng","date":"Sept 2, 2024","date-modified":"last-modified"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}