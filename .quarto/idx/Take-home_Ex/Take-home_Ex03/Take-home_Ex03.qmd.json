{"title":"Take-home Exercise 3: Provincial Competitiveness Index influence on FDI in Vietnam","markdown":{"yaml":{"title":"Take-home Exercise 3: Provincial Competitiveness Index influence on FDI in Vietnam","author":"kai feng","date":"Oct 15, 2024","date-modified":"last-modified","execute":{"eval":true,"echo":true,"freeze":true}},"headingText":"**Introduction**","containsRefs":false,"markdown":"\n\n\n## Provincial Competitiveness Index in Vietnam\n\n**Context:** Vietnam's provinces vary significantly in competitiveness, as captured by the Provincial Competitiveness Index (PCI). This index evaluates key dimensions such as entry costs, land access, transparency, and labor policies, which influence the investment climate and economic potential of each region.\n\n**Challenges:** Provinces aiming to attract investment face challenges related to regional disparities and governance effectiveness. Understanding PCI dimensions is essential for identifying strengths and areas for improvement.\n\n### Analysis Focus\n\n**Objectives:** This analysis aims to evaluate PCI dimensions through linear regression, examining their correlation with FDI projects and FDI registered capital inflow to identify combinations that drive investment.\n\n**Goals:**\n\n-   **Identify Key Factors:** Determine which PCI dimensions most influence FDI total projects and FDI total registered capital.\n\n-   **Province-Specific Insights:** Highlight PCI factors lacking in specific provinces to guide policymaking.\n\n-   **Actionable Recommendations:** Provide targeted suggestions for enhancing PCI dimensions to improve the investment climate.\n\n### Significance\n\nThis project will analyze how PCI dimensions affect Vietnam's economic landscape, offering actionable insights to help policymakers enhance regional competitiveness and stimulate sustainable development.\n\n<br/><br/>\n\n# **1.0 Setup**\n\n## 1.1 Installing R-Packages\n\n::: panel-tabset\n## *Importing and Transforming Data*\n\n-   `sf`:\n\n    -   For handling spatial vector data and transforming it into simple features (`sf`) objects.\n\n    -   Functions like `st_read()` for importing spatial data and `st_transform()` for coordinate reference system transformations.\n\n-   `tidyverse`: For data manipulation and transformation, including functions for working with `tibble` data frames.\n\n-   `readr`: For reading in CSV or other text-based data files.\n\n-   `openxlsx, readxl`: For reading or exporting in XLSX\n\n-   `dplyr`: provide data manipulation capabilities (eg. to group and summarize the relationships between these columns)\n\n## *Styling*\n\n-   `knitr, gtsummary`: For styling table\n\n## *Displaying Maps*\n\n-   `tmap`: For creating thematic maps\n\n-   `animation, png, magick`: For animation work\n\n## *Spatial Autocorrelation*\n\n-   `sfdep`: For performing both local and global spatial autocorrelation analysis\n\n## *Explanatory Analysis*\n\n-   `ggstatsplot`: to visualize relationships with statistical details\n-   `olsrr`: R package for building OLS and performing diagnostics test\n-   `performance`: to visually compare between models\n\n## *Local Analysis*\n\n-   GWmodel\n:::\n\n```{r}\npacman::p_load(tidyverse, sf, readr, tmap, dplyr, knitr, animation, png, magick, openxlsx, readxl, sfdep, ggstatsplot, olsrr, performance, gtsummary, GWmodel)\n```\n\n<br/>\n\n## 1.2 Data Acquisition\n\nWe will be using these dataset:\n\n::: panel-tabset\n## Administrative Boundaries\n\n-   **Source:** [Vietnam - Subnational Administrative Boundaries](https://data.humdata.org/dataset/cod-ab-vnm?) at HDX.\n-   **Province Boundaries**: To map scores from various analyses onto geographic boundaries, enabling visualization of regional competitiveness patterns across the country\n\n## General Data\n\n-   **Source:** [[Vietnam Statistics Office]{.underline}](https://www.gso.gov.vn/en/homepage/) , [Provincial Competitiveness Index](https://pcivietnam.vn/en)\n\n-   **Provincial Competitiveness Index (PCI):** To evaluate the competitive environment of each province, identifying strengths and weaknesses that influence investment potential.\n\n-   **Foreign Direct Investment (FDI):** To assess the attractiveness of provinces for foreign investors and identify trends in investment across different sectors.\n:::\n\n<br/>\n\n## 1.3 Data Preparation and Wrangling\n\n::: panel-tabset\n## Administrative Boundaries\n\n```{r}\n#| eval: false\n\nprovincial_boundaries <- st_read(dsn = \"data/boundaries/provincial\", layer=\"geoBoundaries-VNM-ADM1\")\nclass(provincial_boundaries)\nst_crs(provincial_boundaries)\n\nprovincial_boundaries <- provincial_boundaries %>%\n  st_transform(crs = 3405) # Transform coordinate\n\n# Drop & Rename column\nprovincial_boundaries <- provincial_boundaries %>% \n  select(shapeName, shapeISO, shapeGroup, geometry) %>% \n  rename(\n    province_vn = shapeName,\n    province_code = shapeISO,\n    country_code = shapeGroup\n  )\n\n# Create a new column 'province_en' based on 'province_code'\nprovincial_boundaries <- provincial_boundaries %>%\n  mutate(province_en = case_when(\n    province_code == \"VN-44\" ~ \"An Giang\",\n    province_code == \"VN-43\" ~ \"BRVT\",\n    province_code == \"VN-54\" ~ \"Bac Giang\",\n    province_code == \"VN-53\" ~ \"Bac Kan\",\n    province_code == \"VN-55\" ~ \"Bac Lieu\",\n    province_code == \"VN-56\" ~ \"Bac Ninh\",\n    province_code == \"VN-50\" ~ \"Ben Tre\",\n    province_code == \"VN-31\" ~ \"Binh Dinh\",\n    province_code == \"VN-57\" ~ \"Binh Duong\",\n    province_code == \"VN-58\" ~ \"Binh Phuoc\",\n    province_code == \"VN-40\" ~ \"Binh Thuan\",\n    province_code == \"VN-59\" ~ \"Ca Mau\",\n    province_code == \"VN-CT\" ~ \"Can Tho\",\n    province_code == \"VN-04\" ~ \"Cao Bang\",\n    province_code == \"VN-DN\" ~ \"Da Nang\",\n    province_code == \"VN-33\" ~ \"Dak Lak\",\n    province_code == \"VN-72\" ~ \"Dak Nong\",\n    province_code == \"VN-71\" ~ \"Dien Bien\",\n    province_code == \"VN-39\" ~ \"Dong Nai\",\n    province_code == \"VN-45\" ~ \"Dong Thap\",\n    province_code == \"VN-30\" ~ \"Gia Lai\",\n    province_code == \"VN-SG\" ~ \"HCMC\",\n    province_code == \"VN-03\" ~ \"Ha Giang\",\n    province_code == \"VN-63\" ~ \"Ha Nam\",\n    province_code == \"VN-HN\" ~ \"Ha Noi\",\n    province_code == \"VN-23\" ~ \"Ha Tinh\",\n    province_code == \"VN-61\" ~ \"Hai Duong\",\n    province_code == \"VN-HP\" ~ \"Hai Phong\",\n    province_code == \"VN-73\" ~ \"Hau Giang\",\n    province_code == \"VN-14\" ~ \"Hoa Binh\",\n    province_code == \"VN-66\" ~ \"Hung Yen\",\n    province_code == \"VN-34\" ~ \"Khanh Hoa\",\n    province_code == \"VN-47\" ~ \"Kien Giang\",\n    province_code == \"VN-28\" ~ \"Kon Tum\",\n    province_code == \"VN-01\" ~ \"Lai Chau\",\n    province_code == \"VN-35\" ~ \"Lam Dong\",\n    province_code == \"VN-09\" ~ \"Lang Son\",\n    province_code == \"VN-02\" ~ \"Lao Cai\",\n    province_code == \"VN-41\" ~ \"Long An\",\n    province_code == \"VN-67\" ~ \"Nam Dinh\",\n    province_code == \"VN-22\" ~ \"Nghe An\",\n    province_code == \"VN-18\" ~ \"Ninh Binh\",\n    province_code == \"VN-36\" ~ \"Ninh Thuan\",\n    province_code == \"VN-68\" ~ \"Phu Tho\",\n    province_code == \"VN-32\" ~ \"Phu Yen\",\n    province_code == \"VN-24\" ~ \"Quang Binh\",\n    province_code == \"VN-27\" ~ \"Quang Nam\",\n    province_code == \"VN-29\" ~ \"Quang Ngai\",\n    province_code == \"VN-13\" ~ \"Quang Ninh\",\n    province_code == \"VN-25\" ~ \"Quang Tri\",\n    province_code == \"VN-52\" ~ \"Soc Trang\",\n    province_code == \"VN-05\" ~ \"Son La\",\n    province_code == \"VN-26\" ~ \"TT-Hue\",\n    province_code == \"VN-37\" ~ \"Tay Ninh\",\n    province_code == \"VN-20\" ~ \"Thai Binh\",\n    province_code == \"VN-69\" ~ \"Thai Nguyen\",\n    province_code == \"VN-21\" ~ \"Thanh Hoa\",\n    province_code == \"VN-46\" ~ \"Tien Giang\",\n    province_code == \"VN-51\" ~ \"Tra Vinh\",\n    province_code == \"VN-07\" ~ \"Tuyen Quang\",\n    province_code == \"VN-49\" ~ \"Vinh Long\",\n    province_code == \"VN-70\" ~ \"Vinh Phuc\",\n    province_code == \"VN-06\" ~ \"Yen Bai\"\n  )) %>% \n  select (province_en, everything())\n\nwrite_rds(provincial_boundaries, \"data/rds/provincial_boundaries.rds\")\n```\n\n::: callout-note\nSince Coordinate Reference System of **provincial_boundaries**\n\nis in 4326 (unit of measurement = degree), we have to transform it\n\nAlso, we need to have an english name for each province to allow us to map the province boundary with other dataset\n:::\n\n## General Data\n\n```{r}\n#| eval: false\npci_2021 <- read_xlsx(\"data/provincial_competitiveness_index/2021.xlsx\")\n\npci_2021 <- pci_2021 %>%\n  mutate(\n    province_code = case_when(\n      province_en == \"An Giang\" ~ \"VN-44\",\n      province_en == \"BRVT\" ~ \"VN-43\",\n      province_en == \"Bac Giang\" ~ \"VN-54\",\n      province_en == \"Bac Kan\" ~ \"VN-53\",\n      province_en == \"Bac Lieu\" ~ \"VN-55\",\n      province_en == \"Bac Ninh\" ~ \"VN-56\",\n      province_en == \"Ben Tre\" ~ \"VN-50\",\n      province_en == \"Binh Dinh\" ~ \"VN-31\",\n      province_en == \"Binh Duong\" ~ \"VN-57\",\n      province_en == \"Binh Phuoc\" ~ \"VN-58\",\n      province_en == \"Binh Thuan\" ~ \"VN-40\",\n      province_en == \"Ca Mau\" ~ \"VN-59\",\n      province_en == \"Can Tho\" ~ \"VN-CT\",\n      province_en == \"Cao Bang\" ~ \"VN-04\",\n      province_en == \"Da Nang\" ~ \"VN-DN\",\n      province_en == \"Dak Lak\" ~ \"VN-33\",\n      province_en == \"Dak Nong\" ~ \"VN-72\",\n      province_en == \"Dien Bien\" ~ \"VN-71\",\n      province_en == \"Dong Nai\" ~ \"VN-39\",\n      province_en == \"Dong Thap\" ~ \"VN-45\",\n      province_en == \"Gia Lai\" ~ \"VN-30\",\n      province_en == \"HCMC\" ~ \"VN-SG\",\n      province_en == \"Ha Giang\" ~ \"VN-03\",\n      province_en == \"Ha Nam\" ~ \"VN-63\",\n      province_en == \"Ha Noi\" ~ \"VN-HN\",\n      province_en == \"Ha Tinh\" ~ \"VN-23\",\n      province_en == \"Hai Duong\" ~ \"VN-61\",\n      province_en == \"Hai Phong\" ~ \"VN-HP\",\n      province_en == \"Hau Giang\" ~ \"VN-73\",\n      province_en == \"Hoa Binh\" ~ \"VN-14\",\n      province_en == \"Hung Yen\" ~ \"VN-66\",\n      province_en == \"Khanh Hoa\" ~ \"VN-34\",\n      province_en == \"Kien Giang\" ~ \"VN-47\",\n      province_en == \"Kon Tum\" ~ \"VN-28\",\n      province_en == \"Lai Chau\" ~ \"VN-01\",\n      province_en == \"Lam Dong\" ~ \"VN-35\",\n      province_en == \"Lang Son\" ~ \"VN-09\",\n      province_en == \"Lao Cai\" ~ \"VN-02\",\n      province_en == \"Long An\" ~ \"VN-41\",\n      province_en == \"Nam Dinh\" ~ \"VN-67\",\n      province_en == \"Nghe An\" ~ \"VN-22\",\n      province_en == \"Ninh Binh\" ~ \"VN-18\",\n      province_en == \"Ninh Thuan\" ~ \"VN-36\",\n      province_en == \"Phu Tho\" ~ \"VN-68\",\n      province_en == \"Phu Yen\" ~ \"VN-32\",\n      province_en == \"Quang Binh\" ~ \"VN-24\",\n      province_en == \"Quang Nam\" ~ \"VN-27\",\n      province_en == \"Quang Ngai\" ~ \"VN-29\",\n      province_en == \"Quang Ninh\" ~ \"VN-13\",\n      province_en == \"Quang Tri\" ~ \"VN-25\",\n      province_en == \"Soc Trang\" ~ \"VN-52\",\n      province_en == \"Son La\" ~ \"VN-05\",\n      province_en == \"TT-Hue\" ~ \"VN-26\",\n      province_en == \"Tay Ninh\" ~ \"VN-37\",\n      province_en == \"Thai Binh\" ~ \"VN-20\",\n      province_en == \"Thai Nguyen\" ~ \"VN-69\",\n      province_en == \"Thanh Hoa\" ~ \"VN-21\",\n      province_en == \"Tien Giang\" ~ \"VN-46\",\n      province_en == \"Tra Vinh\" ~ \"VN-51\",\n      province_en == \"Tuyen Quang\" ~ \"VN-07\",\n      province_en == \"Vinh Long\" ~ \"VN-49\",\n      province_en == \"Vinh Phuc\" ~ \"VN-70\",\n      province_en == \"Yen Bai\" ~ \"VN-06\",\n    )\n  ) %>%\n  select(province_en, province_code, everything())\n\nwrite.xlsx(pci_2021, \"data/rds/pci_2021.xlsx\")\n\n\n\n\nfdi <- read_xlsx(\"data/fdi.xlsx\")\n# Rename columns\ncolnames(fdi) <- c(\"province_en\", \"total_project_count\", \n                   \"total_registered_capital\")\n# Remove the first row\nfdi <- fdi[-c(1, 2), ]\n\nfdi <- fdi %>%\n  mutate(\n    province_code = case_when(\n      province_en == \"An Giang\" ~ \"VN-44\",\n      province_en == \"Ba Ria - Vung Tau\" ~ \"VN-43\",\n      province_en == \"Bac Giang\" ~ \"VN-54\",\n      province_en == \"Bac Kan\" ~ \"VN-53\",\n      province_en == \"Bac Lieu\" ~ \"VN-55\",\n      province_en == \"Bac Ninh\" ~ \"VN-56\",\n      province_en == \"Ben Tre\" ~ \"VN-50\",\n      province_en == \"Binh Dinh\" ~ \"VN-31\",\n      province_en == \"Binh  Duong\" ~ \"VN-57\",\n      province_en == \"Binh Phuoc\" ~ \"VN-58\",\n      province_en == \"Binh Thuan\" ~ \"VN-40\",\n      province_en == \"Ca Mau\" ~ \"VN-59\",\n      province_en == \"Can Tho\" ~ \"VN-CT\",\n      province_en == \"Cao Bang\" ~ \"VN-04\",\n      province_en == \"Da Nang\" ~ \"VN-DN\",\n      province_en == \"Dak Lak\" ~ \"VN-33\",\n      province_en == \"Dak Nong\" ~ \"VN-72\",\n      province_en == \"Dien Bien\" ~ \"VN-71\",\n      province_en == \"Dong Nai\" ~ \"VN-39\",\n      province_en == \"Dong Thap\" ~ \"VN-45\",\n      province_en == \"Gia Lai\" ~ \"VN-30\",\n      province_en == \"Ho Chi Minh city\" ~ \"VN-SG\",\n      province_en == \"Ha Giang\" ~ \"VN-03\",\n      province_en == \"Ha Nam\" ~ \"VN-63\",\n      province_en == \"Ha Noi\" ~ \"VN-HN\",\n      province_en == \"Ha Tinh\" ~ \"VN-23\",\n      province_en == \"Hai Duong\" ~ \"VN-61\",\n      province_en == \"Hai Phong\" ~ \"VN-HP\",\n      province_en == \"Hau Giang\" ~ \"VN-73\",\n      province_en == \"Hoa Binh\" ~ \"VN-14\",\n      province_en == \"Hung Yen\" ~ \"VN-66\",\n      province_en == \"Khanh  Hoa\" ~ \"VN-34\",\n      province_en == \"Kien  Giang\" ~ \"VN-47\",\n      province_en == \"Kon Tum\" ~ \"VN-28\",\n      province_en == \"Lai Chau\" ~ \"VN-01\",\n      province_en == \"Lam Dong\" ~ \"VN-35\",\n      province_en == \"Lang Son\" ~ \"VN-09\",\n      province_en == \"Lao Cai\" ~ \"VN-02\",\n      province_en == \"Long An\" ~ \"VN-41\",\n      province_en == \"Nam Dinh\" ~ \"VN-67\",\n      province_en == \"Nghe An\" ~ \"VN-22\",\n      province_en == \"Ninh Binh\" ~ \"VN-18\",\n      province_en == \"Ninh  Thuan\" ~ \"VN-36\",\n      province_en == \"Phu Tho\" ~ \"VN-68\",\n      province_en == \"Phu Yen\" ~ \"VN-32\",\n      province_en == \"Quang Binh\" ~ \"VN-24\",\n      province_en == \"Quang  Nam\" ~ \"VN-27\",\n      province_en == \"Quang  Ngai\" ~ \"VN-29\",\n      province_en == \"Quang Ninh\" ~ \"VN-13\",\n      province_en == \"Quang Tri\" ~ \"VN-25\",\n      province_en == \"Soc Trang\" ~ \"VN-52\",\n      province_en == \"Son La\" ~ \"VN-05\",\n      province_en == \"Thua Thien-Hue\" ~ \"VN-26\",\n      province_en == \"Tay Ninh\" ~ \"VN-37\",\n      province_en == \"Thai Binh\" ~ \"VN-20\",\n      province_en == \"Thai  Nguyen\" ~ \"VN-69\",\n      province_en == \"Thanh Hoa\" ~ \"VN-21\",\n      province_en == \"Tien Giang\" ~ \"VN-46\",\n      province_en == \"Tra Vinh\" ~ \"VN-51\",\n      province_en == \"Tuyen Quang\" ~ \"VN-07\",\n      province_en == \"Vinh Long\" ~ \"VN-49\",\n      province_en == \"Vinh Phuc\" ~ \"VN-70\",\n      province_en == \"Yen Bai\" ~ \"VN-06\",\n    )\n  ) %>%\n  select(province_en, province_code, everything())\n\nfdi <- fdi %>% \n  left_join(provincial_boundaries, by = \"province_code\") %>% \n  select(province_en.x, province_code, total_project_count, total_registered_capital, geometry) %>% \n  rename(province_en = province_en.x)\n\nwrite_rds(fdi, \"data/rds/fdi.rds\")\n```\n\n::: callout-note\nPCI_2021 datasets were inconsistent, so I created a new sheet called 'summary' and renamed the old one to 'summary - old'. The new sheet uses the XLOOKUP function for quick data population from the old sheet, which is much faster compared to handling it in R. In R, different sets of code would be required to manage various data types, making the process more time-consuming.\n\nFor economy_pie dataset, we have also performed simple data reformatting shown in 'Summary' sheet from 'Summary -old' sheet\n:::\n:::\n\n<br/><br/>\n\n# **2.0 Importing the clean set of data**\n\n```{r}\nprovincial_boundaries <- read_rds(\"data/rds/provincial_boundaries.rds\")\n\npci_2021 <- read_xlsx(\"data/rds/pci_2021.xlsx\")\n\nfdi <- read_rds(\"data/rds/fdi.rds\")\n```\n\n<br/><br/>\n\n# **3.0 Prioritization Analysis for Provincial Development: Identifying Key Predictors**\n\n## 3.1 Correlation Matrix\n\nThe PCI consists of nine dimensions, each serving as an independent variable with varying degrees of influence on FDI data.\n\nGiven that some dimensions may exhibit high correlation with one another, it is essential to identify these correlated pairs and select only one variable from each pair for analysis.\n\nTo achieve this, we conduct a correlation matrix to assess the relationships between the dimensions.\n\n```{r}\n#| fig-width: 12\n#| fig-height: 10\n\nggcorrmat(pci_2021[,4:13])\n```\n\n::: callout-note\n**Interpretation**\n\nIf any \\> 0.8 = highly correlated.\n\nWe found there isn't any pair that is highly correlated. We will later reconfirm with the check for \\[4.6 Checking for multicollinearity\\].\n:::\n\n<br>\n\n## 3.2 Conduct Linear Regression\n\nTo explore the influence of each PCI dimension on FDI, we begin with a linear regression model. This initial model will help us determine the relationship between each independent variable (PCI dimensions) and FDI.\n\nBy examining the direction and size of each coefficient, we can start to understand the general influence of each dimension. This setup provides a foundation for refining our analysis and identifying key predictors in subsequent steps\n\n```{r}\npci_2021 <- pci_2021 %>% \n  left_join(fdi %>% \n              select(province_code, total_project_count, total_registered_capital), \n            by = \"province_code\")\n\npci_2021$total_registered_capital <- as.numeric(as.character(pci_2021$total_registered_capital))\n\npci_2021$total_project_count <- as.numeric(as.character(pci_2021$total_project_count))\n```\n\n::: panel-tabset\n## Number of Projects\n\n```{r}\npci_project_mlr <- lm(formula = total_project_count ~ `Entry Costs` + \n                  `Land Access` + Transparency + \n                  `Time Costs` + `Informal charges` + Proactivity + \n                  `Business Support Policy` + `Labor Policy` +\n                `Law & Order`,\n                data=pci_2021)\n\nols_regress(pci_project_mlr)\n\ntbl_regression(pci_project_mlr, \n               intercept = TRUE) %>% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n```\n\n::: callout-note\n**Model Summary**\n\nR-Squared of 0.319, indicating that approximately 31.9% of the variation in FDI total number of projects can be accounted for by the independent variables, adjusting for the number of predictors in the model.\n\n**ANOVA -Analysis of Variance (F test)**\n\nF-ratio of 4.276 -\\> is significant at p \\< 0.001. Hence, our regression model is statistically significant, suggesting that at least some fo the PCI dimensions meaningfully contribute to predicting FDI total number of projects\n\nThe model summary and ANOVA results reveal that while the overall model has a moderate level of predictive power, with some independent variables (such as `Business Support Policy` and `Labor Policy`) showing significant contributions, others (like `Entry Costs` and `Transparency`) did not demonstrate strong effects.\n:::\n\n## Total Registered Capital\n\n```{r}\npci_capital_mlr <- lm(formula = total_registered_capital ~ `Entry Costs` + \n                  `Land Access` + Transparency + \n                  `Time Costs` + `Informal charges` + Proactivity + \n                  `Business Support Policy` + `Labor Policy` +\n                `Law & Order`,\n                data=pci_2021)\n\nols_regress(pci_capital_mlr)\n\ntbl_regression(pci_capital_mlr, \n               intercept = TRUE) %>% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n```\n\n::: callout-note\n**Model Summary**\\\nAdjusted R-Squared of 0.470, indicating that approximately 47.0% of the variation in FDI total registered capital can be accounted for by the independent variables, adjusting for the number of predictors in the model.\n\n**ANOVA - Analysis of Variance (F test)**\\\nF-ratio of 7.219 -\\> is significant at p \\< 0.001. Hence, our regression model is statistically significant, suggesting that at least some of the PCI dimensions meaningfully contribute to predicting FDI total registered capital.\n\nThis model summary and ANOVA indicate that the model has strong predictive power for explaining FDI based on the given PCI dimensions. The significance of specific predictors, such as `Business Support Policy`, `Labor Policy`, and `Time Costs`, suggests that these are influential variables in explaining FDI total registered capital.\n:::\n:::\n\n::: callout-note\n### Summary of Findings\n\nFor the **total number of FDI projects**, the model has an **Adjusted R-Squared of 0.319**, indicating that approximately **31.9%** of the variation can be explained by the independent variables. The **ANOVA results show a significant F-ratio of 4.276 (p \\< 0.001)**, suggesting that some PCI dimensions significantly contribute to the model. However, not all predictors, such as Entry Costs and Transparency, had strong effects.\n\nIn contrast, the model for **total registered capital** has a higher **Adjusted R-Squared of 0.470**, indicating that **47.0%** of the variation is accounted for by the predictors. The **ANOVA shows a significant F-ratio of 7.219 (p \\< 0.001)**, confirming the model's strength. Key variables like Business Support Policy, Labor Policy, and Time Costs are particularly influential in explaining FDI total registered capital.\n:::\n\n<br>\n\n## 3.3 Run model to Select Independent variable\n\nI will now run different stepwise regression models to further investigate the specific positive and negative impacts of the independent variables on FDI.\n\nThis analysis will allow us to quantify how much a **1-unit increase** in each independent variable is expected to influence FDI, providing clearer insights into their contributions to both the total number of projects and total registered capital.\n\nAll of the model will be making use of the base model formulated from \\[4.2 Conduct Linear Regression\\]\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Forward Stepwise\n\n```{r}\npci_project_fw_mlr <- ols_step_forward_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_fw_mlr\n\nplot(pci_project_fw_mlr)\n```\n\n## Backward Stepwise\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_project_bw_mlr <- ols_step_backward_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_bw_mlr\n\nplot(pci_project_bw_mlr)\n```\n\n## Both\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_project_sb_mlr <- ols_step_both_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_sb_mlr\n\nplot(pci_project_sb_mlr)\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Forward Stepwise\n\n```{r}\npci_capital_fw_mlr <- ols_step_forward_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_fw_mlr\n\nplot(pci_capital_fw_mlr)\n```\n\n## Backward Stepwise\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_capital_bw_mlr <- ols_step_backward_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_bw_mlr\n\nplot(pci_capital_bw_mlr)\n```\n\n## Both\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_capital_sb_mlr <- ols_step_both_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_sb_mlr\n\nplot(pci_capital_sb_mlr)\n```\n:::\n:::\n\n<br>\n\n## 3.4 Model Selection\n\nNext, we will utilize a radar chart to visualize the performance of the different models.\n\nThe model that has the most edges touching the outer boundary is considered the best performer, indicating stronger overall results across the evaluated metrics.\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_metric <- compare_performance(pci_project_mlr,\n                              pci_project_fw_mlr$model,\n                              pci_project_bw_mlr$model,\n                              pci_project_sb_mlr$model)\n\nproject_metric$Name <- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", project_metric$Name)\n\n# plot radar\nplot(project_metric)\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_metric <- compare_performance(pci_capital_mlr,\n                              pci_capital_fw_mlr$model,\n                              pci_capital_bw_mlr$model,\n                              pci_capital_sb_mlr$model)\n\ncapital_metric$Name <- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", capital_metric$Name)\n\n# plot radar\nplot(capital_metric)\n```\n:::\n\n::: callout-note\nFor predicting the total number of projects, the best-performing model is `pci_project_sb_mlr`).\n\nIn contrast, for predicting total registered capital, the best-performing model is `pci_capital_sb_mlr`.\n:::\n\n<br>\n\n## 3.5 Visualize model parameters\n\nWe will now utilize the best-performing model to quantify the exact positive or negative impact (in numerical terms) that a one-unit change in the independent variables will have.\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\n#| fig-height: 8\n#| fig-width: 12\n\nggcoefstats(pci_project_sb_mlr$model,\n            sort = \"ascending\")\n```\n\n## Total Registered Capital\n\n```{r}\n#| fig-height: 8\n#| fig-width: 12\n\nggcoefstats(pci_capital_sb_mlr$model,\n            sort = \"ascending\")\n```\n:::\n\n::: callout-note\nTo enhance the attraction of Foreign Direct Investment (FDI) projects and registered capital, policymakers should prioritize improvements in **Labor Policy** and **Business Support Policy**.\n\n-   For every single unit increase in **Labor Policy**, there is a positive influence on attracting more FDI projects and increasing registered capital.\n\n-   Similarly, an increase in **Business Support Policy** also contributes positively to both the total number of FDI projects and the registered capital.\n\nFocusing on these two policy areas will significantly bolster efforts to attract more FDI.\n:::\n\n<br>\n\n## 3.6 Checking for multicollinearity\n\nWe will now confirm our Correlation Matrix by looking at the **Variance Inflation Factor (VIF)**\n\n**Interpretation**\n\n-   \\< 5: low multicollinearity\n\n-   5-10: moderate multcollinearity\n\n-   \\>10: strong multicollinearity\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\ncheck_collinearity(pci_project_sb_mlr$model)\nplot(check_collinearity(pci_project_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, \n    hjust = 1\n  ))\n\n```\n\n## Total Registered Capital\n\n```{r}\ncheck_collinearity(pci_capital_sb_mlr$model)\nplot(check_collinearity(pci_capital_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, \n    hjust = 1\n  ))\n\n```\n:::\n\n::: callout-note\nThere is no Multicollinearity found in both the model used for Total Number of projects and Total Registered Capital\n:::\n\n<br>\n\n## 3.7 Linearity Assumption Test\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_out <- plot(check_model(pci_project_sb_mlr$model,\n                        panel = FALSE))\nproject_out[[2]]\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_out <- plot(check_model(pci_capital_sb_mlr$model,\n                        panel = FALSE))\ncapital_out[[2]]\n```\n:::\n\n<br>\n\n## 3.8 Normality Assumption Test\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nplot(check_normality(pci_project_sb_mlr$model))\n```\n\n## Total Registered Capital\n\n```{r}\nplot(check_normality(pci_capital_sb_mlr$model))\n```\n:::\n\n<br>\n\n## 3.9 Checking of outliers\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_outliers <- check_outliers(pci_project_sb_mlr$model,\n                           method = \"cook\")\n\nproject_outliers\n\nplot(project_outliers <- check_outliers(pci_project_sb_mlr$model,\n                           method = \"cook\"))\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_outliers <- check_outliers(pci_capital_sb_mlr$model,\n                           method = \"cook\")\n\ncapital_outliers\n\nplot(capital_outliers <- check_outliers(pci_capital_sb_mlr$model,\n                           method = \"cook\"))\n```\n:::\n\n::: callout-note\nAfter conducting the tests, I can conclude that both the models used for the Total Number of Projects and Total Registered Capital meet the necessary assumptions and successfully pass the tests.\n:::\n\n<br><br>\n\n# **4.0 Spatial Non-Stationary Assumption**\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Visualising spatial non-stationary\n\n```{r}\nproject_mlr_output <- as.data.frame(pci_project_sb_mlr$model$residuals) %>% \n  rename(`SB_MLR_RES` = `pci_project_sb_mlr$model$residuals`)\n\n# join the newly created data frame\nproject_fdi_sf <- cbind(provincial_boundaries, \n                        project_mlr_output$SB_MLR_RES) %>%\n  rename(`MLR_RES` = `project_mlr_output.SB_MLR_RES`)\n\ntmap_mode(\"view\")\n\ntm_shape(provincial_boundaries)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(project_fdi_sf) +  \n  tm_polygons(col = \"MLR_RES\",\n          alpha = 0.6,\n          size = 0.3,\n          style=\"quantile\") \n\ntmap_mode(\"plot\")\n```\n\n## Spatial stationary test\n\n```{r}\n# compute the distance-based weight matrix by using dnearneigh() function of spdep.\nproject_fdi_sf <- project_fdi_sf %>%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\n# global moran_perm \nglobal_moran_perm(project_fdi_sf$MLR_RES, \n                  project_fdi_sf$nb, \n                  project_fdi_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 999)\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Visualising spatial non-stationary\n\n```{r}\ncapital_mlr_output <- as.data.frame(pci_capital_sb_mlr$model$residuals) %>% \n  rename(`SB_MLR_RES` = `pci_capital_sb_mlr$model$residuals`)\n\n# join the newly created data frame\ncapital_fdi_sf <- cbind(provincial_boundaries, \n                        capital_mlr_output$SB_MLR_RES) %>%\n  rename(`MLR_RES` = `capital_mlr_output.SB_MLR_RES`)\n\ntmap_mode(\"view\")\n\ntm_shape(provincial_boundaries)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(capital_fdi_sf) +  \n  tm_polygons(col = \"MLR_RES\",\n          alpha = 0.6,\n          size = 0.3,\n          style=\"quantile\") \n\ntmap_mode(\"plot\")\n```\n\n## Spatial stationary test\n\n```{r}\n# compute the distance-based weight matrix by using dnearneigh() function of spdep.\ncapital_fdi_sf <- capital_fdi_sf %>%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\n# global moran_perm \nglobal_moran_perm(capital_fdi_sf$MLR_RES, \n                  capital_fdi_sf$nb, \n                  capital_fdi_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 999)\n```\n:::\n:::\n\n::: callout-note\nBased on the results of the Moran's I tests, I can conclude that there is no evidence of significant spatial autocorrelation in the data for either model. This suggests that the distribution of variable does not show systematic clustering or dispersion across the studied area.\n:::\n\n<br/><br/>\n\n# **5.0 Local**\n\n### Preparing the data\n\n```{r}\npci_2021 <- pci_2021 %>% \n  left_join(provincial_boundaries %>% \n              select(province_code, geometry), \n            by = \"province_code\") %>% \n  st_as_sf()\n```\n\n### Fixed VS Adaptive Bandwidth\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Fixed Bandwidth\n\n```{r}\nbw.fixed_project <- bw.gwr(formula = total_project_count ~ \n                             `Entry Costs` + `Land Access` + Transparency + \n                             `Time Costs` + `Informal charges` + Proactivity + \n                             `Business Support Policy` + `Labor Policy` +\n                             `Law & Order`,\n                           data=pci_2021,\n                           approach=\"CV\", \n                           kernel=\"boxcar\", \n                           adaptive=FALSE, \n                           longlat=FALSE)\n\ngwr.fixed_project <- gwr.basic(formula = total_project_count ~ \n                                 `Entry Costs` +  `Land Access` + Transparency + \n                                 `Time Costs` + `Informal charges` + Proactivity + \n                                 `Business Support Policy` + `Labor Policy` +\n                                 `Law & Order`,\n                               data=pci_2021,\n                               bw=bw.fixed_project, \n                               kernel = 'boxcar', \n                               longlat = FALSE)\n\ngwr.fixed_project\n```\n\n## Adaptive Bandwidth\n\n```{r}\nbw.adaptive_project <- bw.gwr(formula = total_project_count ~ \n                                `Entry Costs` + `Land Access` + Transparency + \n                                `Time Costs` + `Informal charges` + Proactivity +\n                                `Business Support Policy` + `Labor Policy` +\n                                `Law & Order`,\n                              data=pci_2021,\n                              approach=\"CV\", \n                              kernel=\"boxcar\", \n                              adaptive=TRUE, \n                              longlat=FALSE)\n\ngwr.adaptive_project <- gwr.basic(formula = total_project_count ~ \n                                    `Entry Costs` + `Land Access` + Transparency +\n                                    `Time Costs` + `Informal charges` + Proactivity + \n                                    `Business Support Policy` + `Labor Policy` +\n                                    `Law & Order`,\n                                  data=pci_2021,\n                                  bw=bw.adaptive_project,\n                                  kernel = 'boxcar',\n                                  adaptive=TRUE, \n                                  longlat = FALSE)\n\ngwr.adaptive_project\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Fixed Bandwidth\n\n```{r}\nbw.fixed_capital <- bw.gwr(formula = total_registered_capital ~ \n                             `Entry Costs` + `Land Access` + Transparency + \n                             `Time Costs` + `Informal charges` + Proactivity + \n                             `Business Support Policy` + `Labor Policy` +\n                             `Law & Order`,\n                           data=pci_2021,\n                           approach=\"CV\", \n                           kernel=\"bisquare\", \n                           adaptive=FALSE, \n                           longlat=FALSE)\n\ngwr.fixed_capital <- gwr.basic(formula = total_registered_capital ~ \n                                 `Entry Costs` + `Land Access` + Transparency + \n                                 `Time Costs` + `Informal charges` + Proactivity + \n                                 `Business Support Policy` + `Labor Policy` +\n                                 `Law & Order`,\n                               data=pci_2021,\n                               bw=bw.fixed_capital, \n                               kernel = 'bisquare', \n                               longlat = FALSE)\n\ngwr.fixed_capital\n```\n\n## Adaptive Bandwidth\n\n```{r}\nbw.adaptive_capital <- bw.gwr(formula = total_registered_capital ~ \n                                `Entry Costs` + `Land Access` + Transparency + \n                                `Time Costs` + `Informal charges` + Proactivity +\n                                `Business Support Policy` + `Labor Policy` +\n                                `Law & Order`,\n                              data=pci_2021,\n                              approach=\"CV\", \n                              kernel=\"bisquare\", \n                              adaptive=TRUE, \n                              longlat=FALSE)\n\ngwr.adaptive_capital <- gwr.basic(formula = total_registered_capital ~ \n                                    `Entry Costs` + `Land Access` + Transparency + \n                                    `Time Costs` + `Informal charges` + Proactivity + \n                                    `Business Support Policy` + `Labor Policy` +\n                                    `Law & Order`,\n                                  data=pci_2021,\n                                  bw=bw.adaptive_capital, \n                                  kernel = 'bisquare',\n                                  adaptive=TRUE, \n                                  longlat = FALSE)\n\ngwr.adaptive_capital\n```\n:::\n:::\n\n<br/>\n\n### Visualising Local R2\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\n# Converting SDF into sf data.frame\npci_2021 <- st_as_sf(gwr.fixed_project$SDF) %>%\n  st_transform(crs=3405)\n\n\ngwr.fixed.output_project <- as.data.frame(gwr.fixed_project$SDF)\npci_2021.fixed_project <- cbind(pci_2021, as.matrix(gwr.fixed.output_project))\n\nglimpse(pci_2021.fixed_project)\n```\n\n```{r}\n# Set tmap options to check and fix any invalid polygons\ntmap_options(check.and.fix = TRUE)\n\ntmap_mode(\"view\")\n\nstr(pci_2021.fixed_project$Local_R2)\npci_2021.fixed_project$Local_R2 <- unlist(pci_2021.fixed_project$Local_R2)\n\n\ntm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.fixed_project) +  \n  tm_polygons(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n```\n\n## Total Registered Capital\n\n```{r}\n# Converting SDF into sf data.frame\npci_2021 <- st_as_sf(gwr.adaptive_capital$SDF) %>%\n  st_transform(crs=3405)\n\n\ngwr.adaptive.output_capital <- as.data.frame(gwr.adaptive_capital$SDF)\npci_2021.adaptive_capital <- cbind(pci_2021, as.matrix(gwr.adaptive.output_capital))\n\nglimpse(pci_2021.adaptive_capital)\n```\n\n```{r}\n# Set tmap options to check and fix any invalid polygons\ntmap_options(check.and.fix = TRUE)\n\ntmap_mode(\"view\")\n\nstr(pci_2021.adaptive_capital$Local_R2)\npci_2021.adaptive_capital$Local_R2 <- unlist(pci_2021.adaptive_capital$Local_R2)\n\n\ntm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.adaptive_capital) +  \n  tm_polygons(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n```\n:::\n\n<br>\n\n### Visualising coefficient estimates\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\ntmap_mode(\"view\")\n\nAREA_SQM_SE <- tm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.fixed_project) +  \n  tm_polygons(col = \"Transparency_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n\nAREA_SQM_TV <- tm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.adaptive_capital) +  \n  tm_polygons(col = \"Transparency_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n```\n\n## Total Registered Capital\n\n```{r}\n\n```\n:::\n\n<br><br>\n\n# **6.0 Shiny Storyboard**\n\n## 6.1 Global Explanatory Model\n\n### 6.1.1 Multiple Linear Regression (MLR)\n\nMultiple Linear Regression (MLR) provides a baseline model to predict an outcome using multiple predictor variables. It assumes a consistent, global relationship across all data points, offering a broad understanding of how these variables influence the dependent variable overall.\n\nUsers have the flexibility to select specific combinations of predictor variables (e.g., PCI factors) to explore different modeling outcomes and compare how these combinations affect results.\n\n**Interpretation**: A higher Adjusted R2 indicates that the model more effectively explains the variation in the outcome. Additionally, p-value reflects the statistical significance of the model, with lower values indicating stronger confidence in the predictors’ influence.\n\n![](images/clipboard-1002269832.png)\n\n<br>\n\n### 6.1.2 Stepwise Model Selection\n\n**Stepwise Model Selection** allows users to refine the Multiple Linear Regression model by adding or removing predictor variables in a systematic way.\n\nUsers can select from 3 approaches:\n\n-   **forward selection** (starting with no predictors and adding them),\n\n-   **backward elimination** (starting with all predictors and removing them),\n\n-   or **both** (a combination of adding and removing).\n\nUsers also have control over the **confidence level** (e.g., 0.95 or 0.99), adjusting the stringency for including predictors based on statistical significance.\n\n**Interpretation and Visualization**: A radar chart provides a visual comparison of different models, allowing users to select and view how models perform across chosen predictors and confidence levels. This helps in identifying the most effective model based on the desired balance of predictors and statistical robustness.\n\n![](images/clipboard-1995167839.png)\n\n<br>\n\n### 6.1.3 Visualise Model Parameters\n\n**Visualize Model Parameters** offers users an interactive way to examine and compare the effects of predictor variables across different stepwise models. Users can select their preferred model from the stepwise selection results and sort parameter values in ascending or descending order for easier comparison.\n\n**Interpretation and Customization**: This visualization provides a clear view of each predictor’s influence on the outcome variable within the selected model, helping users assess the relative importance of predictors. By sorting the parameters, users can quickly identify the most impactful variables or spot subtle differences across models, aiding in deeper analysis and model refinement.\n\n![](images/clipboard-1084091748.png)\n\n<br>\n\n## 6.2 Local Explanatory Model\n\n### 6.2.1 Bandwidth Selection\n\n**Bandwidth Selection** in Geographically Weighted Regression (GWR) allows users to fine-tune the model’s spatial sensitivity by choosing between **fixed** and **adaptive** bandwidth options.\n\n-   **Side-by-Side Comparison**:\\\n    Users can compare the effects of **fixed** vs. **adaptive** bandwidths side-by-side. This comparison highlights how each bandwidth type influences the spatial scale of the analysis:\n\n    -   **Fixed bandwidth** applies a constant spatial radius for all data points, which is ideal for evenly spaced data.\n\n    -   **Adaptive bandwidth** adjusts based on data density, using a larger bandwidth in sparse areas and a smaller one in dense areas, enhancing accuracy in regions with varying data distributions.\n\n-   **Selection Options for Each Bandwidth Type**:\n\n    -   **Approach**: Users can choose from **cross-validation** or **A/C corrected** methods to optimize the bandwidth.\n\n    -   **Kernel Method**: Users can select the **kernel type** (e.g., Gaussian, bisquare, or tricube) to define the shape and weighting of spatial influence around each data point, tailoring the model to the spatial structure of the data.\n\n**Purpose**:\\\nThis flexible bandwidth selection process allows users to determine the optimal balance of local vs. global influence, enhancing model accuracy and providing insights into spatial patterns at different scales.\n\n![](images/clipboard-4235001143.png)\n\n<br>\n\n### 6.2.2 Visualise Local R2\n\n**Visualizing Local** **R2** provides an in-depth look at how well the Geographically Weighted Regression (GWR) model explains variations in the outcome across different areas. This visualization highlights spatial differences in model performance, making it easier to identify regions where predictors more effectively capture local patterns.\n\n-   **Customization Options**:\n\n    -   **Bandwidth Type**: Choose between **fixed** or **adaptive** bandwidth to control the scale of spatial influence.\n\n    -   **Bandwidth Optimization Approach**: Select **cross-validation** or **A/C corrected** to determine the optimal bandwidth, allowing a focus on either predictive accuracy or model simplicity.\n\n    -   **Kernel Method**: Choose the kernel type (e.g., Gaussian, bisquare, or tricube) to set the shape and weighting of spatial influence, refining how local R2 values are calculated across locations.\n\n\\\nThis flexible visualization helps users assess where the model has strong or weak explanatory power across the study area, offering insights into local model fit. By adjusting bandwidth, approach, and kernel, users can explore how these choices impact model performance, identifying areas with robust predictions and areas needing further investigation.\n\n![](images/clipboard-2012200626.png)\n\n<br>\n\n## 6.5 Spatial Non-Stationary Assumption\n\nThe Spatial Non-Stationarity Assumption tool helps assess whether relationships between variables vary across different spatial locations. In this analysis, it tests whether the influence of **Provincial Competitiveness Index (PCI) dimensions** on **FDI metrics** (Total Number of Projects and Total Registered Capital) remains consistent across provinces or if it changes depending on regional characteristics.\n\n![](images/Spatial%20Non-Stationary%20Assumption.jpg)\n","srcMarkdownNoYaml":"\n\n# **Introduction**\n\n## Provincial Competitiveness Index in Vietnam\n\n**Context:** Vietnam's provinces vary significantly in competitiveness, as captured by the Provincial Competitiveness Index (PCI). This index evaluates key dimensions such as entry costs, land access, transparency, and labor policies, which influence the investment climate and economic potential of each region.\n\n**Challenges:** Provinces aiming to attract investment face challenges related to regional disparities and governance effectiveness. Understanding PCI dimensions is essential for identifying strengths and areas for improvement.\n\n### Analysis Focus\n\n**Objectives:** This analysis aims to evaluate PCI dimensions through linear regression, examining their correlation with FDI projects and FDI registered capital inflow to identify combinations that drive investment.\n\n**Goals:**\n\n-   **Identify Key Factors:** Determine which PCI dimensions most influence FDI total projects and FDI total registered capital.\n\n-   **Province-Specific Insights:** Highlight PCI factors lacking in specific provinces to guide policymaking.\n\n-   **Actionable Recommendations:** Provide targeted suggestions for enhancing PCI dimensions to improve the investment climate.\n\n### Significance\n\nThis project will analyze how PCI dimensions affect Vietnam's economic landscape, offering actionable insights to help policymakers enhance regional competitiveness and stimulate sustainable development.\n\n<br/><br/>\n\n# **1.0 Setup**\n\n## 1.1 Installing R-Packages\n\n::: panel-tabset\n## *Importing and Transforming Data*\n\n-   `sf`:\n\n    -   For handling spatial vector data and transforming it into simple features (`sf`) objects.\n\n    -   Functions like `st_read()` for importing spatial data and `st_transform()` for coordinate reference system transformations.\n\n-   `tidyverse`: For data manipulation and transformation, including functions for working with `tibble` data frames.\n\n-   `readr`: For reading in CSV or other text-based data files.\n\n-   `openxlsx, readxl`: For reading or exporting in XLSX\n\n-   `dplyr`: provide data manipulation capabilities (eg. to group and summarize the relationships between these columns)\n\n## *Styling*\n\n-   `knitr, gtsummary`: For styling table\n\n## *Displaying Maps*\n\n-   `tmap`: For creating thematic maps\n\n-   `animation, png, magick`: For animation work\n\n## *Spatial Autocorrelation*\n\n-   `sfdep`: For performing both local and global spatial autocorrelation analysis\n\n## *Explanatory Analysis*\n\n-   `ggstatsplot`: to visualize relationships with statistical details\n-   `olsrr`: R package for building OLS and performing diagnostics test\n-   `performance`: to visually compare between models\n\n## *Local Analysis*\n\n-   GWmodel\n:::\n\n```{r}\npacman::p_load(tidyverse, sf, readr, tmap, dplyr, knitr, animation, png, magick, openxlsx, readxl, sfdep, ggstatsplot, olsrr, performance, gtsummary, GWmodel)\n```\n\n<br/>\n\n## 1.2 Data Acquisition\n\nWe will be using these dataset:\n\n::: panel-tabset\n## Administrative Boundaries\n\n-   **Source:** [Vietnam - Subnational Administrative Boundaries](https://data.humdata.org/dataset/cod-ab-vnm?) at HDX.\n-   **Province Boundaries**: To map scores from various analyses onto geographic boundaries, enabling visualization of regional competitiveness patterns across the country\n\n## General Data\n\n-   **Source:** [[Vietnam Statistics Office]{.underline}](https://www.gso.gov.vn/en/homepage/) , [Provincial Competitiveness Index](https://pcivietnam.vn/en)\n\n-   **Provincial Competitiveness Index (PCI):** To evaluate the competitive environment of each province, identifying strengths and weaknesses that influence investment potential.\n\n-   **Foreign Direct Investment (FDI):** To assess the attractiveness of provinces for foreign investors and identify trends in investment across different sectors.\n:::\n\n<br/>\n\n## 1.3 Data Preparation and Wrangling\n\n::: panel-tabset\n## Administrative Boundaries\n\n```{r}\n#| eval: false\n\nprovincial_boundaries <- st_read(dsn = \"data/boundaries/provincial\", layer=\"geoBoundaries-VNM-ADM1\")\nclass(provincial_boundaries)\nst_crs(provincial_boundaries)\n\nprovincial_boundaries <- provincial_boundaries %>%\n  st_transform(crs = 3405) # Transform coordinate\n\n# Drop & Rename column\nprovincial_boundaries <- provincial_boundaries %>% \n  select(shapeName, shapeISO, shapeGroup, geometry) %>% \n  rename(\n    province_vn = shapeName,\n    province_code = shapeISO,\n    country_code = shapeGroup\n  )\n\n# Create a new column 'province_en' based on 'province_code'\nprovincial_boundaries <- provincial_boundaries %>%\n  mutate(province_en = case_when(\n    province_code == \"VN-44\" ~ \"An Giang\",\n    province_code == \"VN-43\" ~ \"BRVT\",\n    province_code == \"VN-54\" ~ \"Bac Giang\",\n    province_code == \"VN-53\" ~ \"Bac Kan\",\n    province_code == \"VN-55\" ~ \"Bac Lieu\",\n    province_code == \"VN-56\" ~ \"Bac Ninh\",\n    province_code == \"VN-50\" ~ \"Ben Tre\",\n    province_code == \"VN-31\" ~ \"Binh Dinh\",\n    province_code == \"VN-57\" ~ \"Binh Duong\",\n    province_code == \"VN-58\" ~ \"Binh Phuoc\",\n    province_code == \"VN-40\" ~ \"Binh Thuan\",\n    province_code == \"VN-59\" ~ \"Ca Mau\",\n    province_code == \"VN-CT\" ~ \"Can Tho\",\n    province_code == \"VN-04\" ~ \"Cao Bang\",\n    province_code == \"VN-DN\" ~ \"Da Nang\",\n    province_code == \"VN-33\" ~ \"Dak Lak\",\n    province_code == \"VN-72\" ~ \"Dak Nong\",\n    province_code == \"VN-71\" ~ \"Dien Bien\",\n    province_code == \"VN-39\" ~ \"Dong Nai\",\n    province_code == \"VN-45\" ~ \"Dong Thap\",\n    province_code == \"VN-30\" ~ \"Gia Lai\",\n    province_code == \"VN-SG\" ~ \"HCMC\",\n    province_code == \"VN-03\" ~ \"Ha Giang\",\n    province_code == \"VN-63\" ~ \"Ha Nam\",\n    province_code == \"VN-HN\" ~ \"Ha Noi\",\n    province_code == \"VN-23\" ~ \"Ha Tinh\",\n    province_code == \"VN-61\" ~ \"Hai Duong\",\n    province_code == \"VN-HP\" ~ \"Hai Phong\",\n    province_code == \"VN-73\" ~ \"Hau Giang\",\n    province_code == \"VN-14\" ~ \"Hoa Binh\",\n    province_code == \"VN-66\" ~ \"Hung Yen\",\n    province_code == \"VN-34\" ~ \"Khanh Hoa\",\n    province_code == \"VN-47\" ~ \"Kien Giang\",\n    province_code == \"VN-28\" ~ \"Kon Tum\",\n    province_code == \"VN-01\" ~ \"Lai Chau\",\n    province_code == \"VN-35\" ~ \"Lam Dong\",\n    province_code == \"VN-09\" ~ \"Lang Son\",\n    province_code == \"VN-02\" ~ \"Lao Cai\",\n    province_code == \"VN-41\" ~ \"Long An\",\n    province_code == \"VN-67\" ~ \"Nam Dinh\",\n    province_code == \"VN-22\" ~ \"Nghe An\",\n    province_code == \"VN-18\" ~ \"Ninh Binh\",\n    province_code == \"VN-36\" ~ \"Ninh Thuan\",\n    province_code == \"VN-68\" ~ \"Phu Tho\",\n    province_code == \"VN-32\" ~ \"Phu Yen\",\n    province_code == \"VN-24\" ~ \"Quang Binh\",\n    province_code == \"VN-27\" ~ \"Quang Nam\",\n    province_code == \"VN-29\" ~ \"Quang Ngai\",\n    province_code == \"VN-13\" ~ \"Quang Ninh\",\n    province_code == \"VN-25\" ~ \"Quang Tri\",\n    province_code == \"VN-52\" ~ \"Soc Trang\",\n    province_code == \"VN-05\" ~ \"Son La\",\n    province_code == \"VN-26\" ~ \"TT-Hue\",\n    province_code == \"VN-37\" ~ \"Tay Ninh\",\n    province_code == \"VN-20\" ~ \"Thai Binh\",\n    province_code == \"VN-69\" ~ \"Thai Nguyen\",\n    province_code == \"VN-21\" ~ \"Thanh Hoa\",\n    province_code == \"VN-46\" ~ \"Tien Giang\",\n    province_code == \"VN-51\" ~ \"Tra Vinh\",\n    province_code == \"VN-07\" ~ \"Tuyen Quang\",\n    province_code == \"VN-49\" ~ \"Vinh Long\",\n    province_code == \"VN-70\" ~ \"Vinh Phuc\",\n    province_code == \"VN-06\" ~ \"Yen Bai\"\n  )) %>% \n  select (province_en, everything())\n\nwrite_rds(provincial_boundaries, \"data/rds/provincial_boundaries.rds\")\n```\n\n::: callout-note\nSince Coordinate Reference System of **provincial_boundaries**\n\nis in 4326 (unit of measurement = degree), we have to transform it\n\nAlso, we need to have an english name for each province to allow us to map the province boundary with other dataset\n:::\n\n## General Data\n\n```{r}\n#| eval: false\npci_2021 <- read_xlsx(\"data/provincial_competitiveness_index/2021.xlsx\")\n\npci_2021 <- pci_2021 %>%\n  mutate(\n    province_code = case_when(\n      province_en == \"An Giang\" ~ \"VN-44\",\n      province_en == \"BRVT\" ~ \"VN-43\",\n      province_en == \"Bac Giang\" ~ \"VN-54\",\n      province_en == \"Bac Kan\" ~ \"VN-53\",\n      province_en == \"Bac Lieu\" ~ \"VN-55\",\n      province_en == \"Bac Ninh\" ~ \"VN-56\",\n      province_en == \"Ben Tre\" ~ \"VN-50\",\n      province_en == \"Binh Dinh\" ~ \"VN-31\",\n      province_en == \"Binh Duong\" ~ \"VN-57\",\n      province_en == \"Binh Phuoc\" ~ \"VN-58\",\n      province_en == \"Binh Thuan\" ~ \"VN-40\",\n      province_en == \"Ca Mau\" ~ \"VN-59\",\n      province_en == \"Can Tho\" ~ \"VN-CT\",\n      province_en == \"Cao Bang\" ~ \"VN-04\",\n      province_en == \"Da Nang\" ~ \"VN-DN\",\n      province_en == \"Dak Lak\" ~ \"VN-33\",\n      province_en == \"Dak Nong\" ~ \"VN-72\",\n      province_en == \"Dien Bien\" ~ \"VN-71\",\n      province_en == \"Dong Nai\" ~ \"VN-39\",\n      province_en == \"Dong Thap\" ~ \"VN-45\",\n      province_en == \"Gia Lai\" ~ \"VN-30\",\n      province_en == \"HCMC\" ~ \"VN-SG\",\n      province_en == \"Ha Giang\" ~ \"VN-03\",\n      province_en == \"Ha Nam\" ~ \"VN-63\",\n      province_en == \"Ha Noi\" ~ \"VN-HN\",\n      province_en == \"Ha Tinh\" ~ \"VN-23\",\n      province_en == \"Hai Duong\" ~ \"VN-61\",\n      province_en == \"Hai Phong\" ~ \"VN-HP\",\n      province_en == \"Hau Giang\" ~ \"VN-73\",\n      province_en == \"Hoa Binh\" ~ \"VN-14\",\n      province_en == \"Hung Yen\" ~ \"VN-66\",\n      province_en == \"Khanh Hoa\" ~ \"VN-34\",\n      province_en == \"Kien Giang\" ~ \"VN-47\",\n      province_en == \"Kon Tum\" ~ \"VN-28\",\n      province_en == \"Lai Chau\" ~ \"VN-01\",\n      province_en == \"Lam Dong\" ~ \"VN-35\",\n      province_en == \"Lang Son\" ~ \"VN-09\",\n      province_en == \"Lao Cai\" ~ \"VN-02\",\n      province_en == \"Long An\" ~ \"VN-41\",\n      province_en == \"Nam Dinh\" ~ \"VN-67\",\n      province_en == \"Nghe An\" ~ \"VN-22\",\n      province_en == \"Ninh Binh\" ~ \"VN-18\",\n      province_en == \"Ninh Thuan\" ~ \"VN-36\",\n      province_en == \"Phu Tho\" ~ \"VN-68\",\n      province_en == \"Phu Yen\" ~ \"VN-32\",\n      province_en == \"Quang Binh\" ~ \"VN-24\",\n      province_en == \"Quang Nam\" ~ \"VN-27\",\n      province_en == \"Quang Ngai\" ~ \"VN-29\",\n      province_en == \"Quang Ninh\" ~ \"VN-13\",\n      province_en == \"Quang Tri\" ~ \"VN-25\",\n      province_en == \"Soc Trang\" ~ \"VN-52\",\n      province_en == \"Son La\" ~ \"VN-05\",\n      province_en == \"TT-Hue\" ~ \"VN-26\",\n      province_en == \"Tay Ninh\" ~ \"VN-37\",\n      province_en == \"Thai Binh\" ~ \"VN-20\",\n      province_en == \"Thai Nguyen\" ~ \"VN-69\",\n      province_en == \"Thanh Hoa\" ~ \"VN-21\",\n      province_en == \"Tien Giang\" ~ \"VN-46\",\n      province_en == \"Tra Vinh\" ~ \"VN-51\",\n      province_en == \"Tuyen Quang\" ~ \"VN-07\",\n      province_en == \"Vinh Long\" ~ \"VN-49\",\n      province_en == \"Vinh Phuc\" ~ \"VN-70\",\n      province_en == \"Yen Bai\" ~ \"VN-06\",\n    )\n  ) %>%\n  select(province_en, province_code, everything())\n\nwrite.xlsx(pci_2021, \"data/rds/pci_2021.xlsx\")\n\n\n\n\nfdi <- read_xlsx(\"data/fdi.xlsx\")\n# Rename columns\ncolnames(fdi) <- c(\"province_en\", \"total_project_count\", \n                   \"total_registered_capital\")\n# Remove the first row\nfdi <- fdi[-c(1, 2), ]\n\nfdi <- fdi %>%\n  mutate(\n    province_code = case_when(\n      province_en == \"An Giang\" ~ \"VN-44\",\n      province_en == \"Ba Ria - Vung Tau\" ~ \"VN-43\",\n      province_en == \"Bac Giang\" ~ \"VN-54\",\n      province_en == \"Bac Kan\" ~ \"VN-53\",\n      province_en == \"Bac Lieu\" ~ \"VN-55\",\n      province_en == \"Bac Ninh\" ~ \"VN-56\",\n      province_en == \"Ben Tre\" ~ \"VN-50\",\n      province_en == \"Binh Dinh\" ~ \"VN-31\",\n      province_en == \"Binh  Duong\" ~ \"VN-57\",\n      province_en == \"Binh Phuoc\" ~ \"VN-58\",\n      province_en == \"Binh Thuan\" ~ \"VN-40\",\n      province_en == \"Ca Mau\" ~ \"VN-59\",\n      province_en == \"Can Tho\" ~ \"VN-CT\",\n      province_en == \"Cao Bang\" ~ \"VN-04\",\n      province_en == \"Da Nang\" ~ \"VN-DN\",\n      province_en == \"Dak Lak\" ~ \"VN-33\",\n      province_en == \"Dak Nong\" ~ \"VN-72\",\n      province_en == \"Dien Bien\" ~ \"VN-71\",\n      province_en == \"Dong Nai\" ~ \"VN-39\",\n      province_en == \"Dong Thap\" ~ \"VN-45\",\n      province_en == \"Gia Lai\" ~ \"VN-30\",\n      province_en == \"Ho Chi Minh city\" ~ \"VN-SG\",\n      province_en == \"Ha Giang\" ~ \"VN-03\",\n      province_en == \"Ha Nam\" ~ \"VN-63\",\n      province_en == \"Ha Noi\" ~ \"VN-HN\",\n      province_en == \"Ha Tinh\" ~ \"VN-23\",\n      province_en == \"Hai Duong\" ~ \"VN-61\",\n      province_en == \"Hai Phong\" ~ \"VN-HP\",\n      province_en == \"Hau Giang\" ~ \"VN-73\",\n      province_en == \"Hoa Binh\" ~ \"VN-14\",\n      province_en == \"Hung Yen\" ~ \"VN-66\",\n      province_en == \"Khanh  Hoa\" ~ \"VN-34\",\n      province_en == \"Kien  Giang\" ~ \"VN-47\",\n      province_en == \"Kon Tum\" ~ \"VN-28\",\n      province_en == \"Lai Chau\" ~ \"VN-01\",\n      province_en == \"Lam Dong\" ~ \"VN-35\",\n      province_en == \"Lang Son\" ~ \"VN-09\",\n      province_en == \"Lao Cai\" ~ \"VN-02\",\n      province_en == \"Long An\" ~ \"VN-41\",\n      province_en == \"Nam Dinh\" ~ \"VN-67\",\n      province_en == \"Nghe An\" ~ \"VN-22\",\n      province_en == \"Ninh Binh\" ~ \"VN-18\",\n      province_en == \"Ninh  Thuan\" ~ \"VN-36\",\n      province_en == \"Phu Tho\" ~ \"VN-68\",\n      province_en == \"Phu Yen\" ~ \"VN-32\",\n      province_en == \"Quang Binh\" ~ \"VN-24\",\n      province_en == \"Quang  Nam\" ~ \"VN-27\",\n      province_en == \"Quang  Ngai\" ~ \"VN-29\",\n      province_en == \"Quang Ninh\" ~ \"VN-13\",\n      province_en == \"Quang Tri\" ~ \"VN-25\",\n      province_en == \"Soc Trang\" ~ \"VN-52\",\n      province_en == \"Son La\" ~ \"VN-05\",\n      province_en == \"Thua Thien-Hue\" ~ \"VN-26\",\n      province_en == \"Tay Ninh\" ~ \"VN-37\",\n      province_en == \"Thai Binh\" ~ \"VN-20\",\n      province_en == \"Thai  Nguyen\" ~ \"VN-69\",\n      province_en == \"Thanh Hoa\" ~ \"VN-21\",\n      province_en == \"Tien Giang\" ~ \"VN-46\",\n      province_en == \"Tra Vinh\" ~ \"VN-51\",\n      province_en == \"Tuyen Quang\" ~ \"VN-07\",\n      province_en == \"Vinh Long\" ~ \"VN-49\",\n      province_en == \"Vinh Phuc\" ~ \"VN-70\",\n      province_en == \"Yen Bai\" ~ \"VN-06\",\n    )\n  ) %>%\n  select(province_en, province_code, everything())\n\nfdi <- fdi %>% \n  left_join(provincial_boundaries, by = \"province_code\") %>% \n  select(province_en.x, province_code, total_project_count, total_registered_capital, geometry) %>% \n  rename(province_en = province_en.x)\n\nwrite_rds(fdi, \"data/rds/fdi.rds\")\n```\n\n::: callout-note\nPCI_2021 datasets were inconsistent, so I created a new sheet called 'summary' and renamed the old one to 'summary - old'. The new sheet uses the XLOOKUP function for quick data population from the old sheet, which is much faster compared to handling it in R. In R, different sets of code would be required to manage various data types, making the process more time-consuming.\n\nFor economy_pie dataset, we have also performed simple data reformatting shown in 'Summary' sheet from 'Summary -old' sheet\n:::\n:::\n\n<br/><br/>\n\n# **2.0 Importing the clean set of data**\n\n```{r}\nprovincial_boundaries <- read_rds(\"data/rds/provincial_boundaries.rds\")\n\npci_2021 <- read_xlsx(\"data/rds/pci_2021.xlsx\")\n\nfdi <- read_rds(\"data/rds/fdi.rds\")\n```\n\n<br/><br/>\n\n# **3.0 Prioritization Analysis for Provincial Development: Identifying Key Predictors**\n\n## 3.1 Correlation Matrix\n\nThe PCI consists of nine dimensions, each serving as an independent variable with varying degrees of influence on FDI data.\n\nGiven that some dimensions may exhibit high correlation with one another, it is essential to identify these correlated pairs and select only one variable from each pair for analysis.\n\nTo achieve this, we conduct a correlation matrix to assess the relationships between the dimensions.\n\n```{r}\n#| fig-width: 12\n#| fig-height: 10\n\nggcorrmat(pci_2021[,4:13])\n```\n\n::: callout-note\n**Interpretation**\n\nIf any \\> 0.8 = highly correlated.\n\nWe found there isn't any pair that is highly correlated. We will later reconfirm with the check for \\[4.6 Checking for multicollinearity\\].\n:::\n\n<br>\n\n## 3.2 Conduct Linear Regression\n\nTo explore the influence of each PCI dimension on FDI, we begin with a linear regression model. This initial model will help us determine the relationship between each independent variable (PCI dimensions) and FDI.\n\nBy examining the direction and size of each coefficient, we can start to understand the general influence of each dimension. This setup provides a foundation for refining our analysis and identifying key predictors in subsequent steps\n\n```{r}\npci_2021 <- pci_2021 %>% \n  left_join(fdi %>% \n              select(province_code, total_project_count, total_registered_capital), \n            by = \"province_code\")\n\npci_2021$total_registered_capital <- as.numeric(as.character(pci_2021$total_registered_capital))\n\npci_2021$total_project_count <- as.numeric(as.character(pci_2021$total_project_count))\n```\n\n::: panel-tabset\n## Number of Projects\n\n```{r}\npci_project_mlr <- lm(formula = total_project_count ~ `Entry Costs` + \n                  `Land Access` + Transparency + \n                  `Time Costs` + `Informal charges` + Proactivity + \n                  `Business Support Policy` + `Labor Policy` +\n                `Law & Order`,\n                data=pci_2021)\n\nols_regress(pci_project_mlr)\n\ntbl_regression(pci_project_mlr, \n               intercept = TRUE) %>% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n```\n\n::: callout-note\n**Model Summary**\n\nR-Squared of 0.319, indicating that approximately 31.9% of the variation in FDI total number of projects can be accounted for by the independent variables, adjusting for the number of predictors in the model.\n\n**ANOVA -Analysis of Variance (F test)**\n\nF-ratio of 4.276 -\\> is significant at p \\< 0.001. Hence, our regression model is statistically significant, suggesting that at least some fo the PCI dimensions meaningfully contribute to predicting FDI total number of projects\n\nThe model summary and ANOVA results reveal that while the overall model has a moderate level of predictive power, with some independent variables (such as `Business Support Policy` and `Labor Policy`) showing significant contributions, others (like `Entry Costs` and `Transparency`) did not demonstrate strong effects.\n:::\n\n## Total Registered Capital\n\n```{r}\npci_capital_mlr <- lm(formula = total_registered_capital ~ `Entry Costs` + \n                  `Land Access` + Transparency + \n                  `Time Costs` + `Informal charges` + Proactivity + \n                  `Business Support Policy` + `Labor Policy` +\n                `Law & Order`,\n                data=pci_2021)\n\nols_regress(pci_capital_mlr)\n\ntbl_regression(pci_capital_mlr, \n               intercept = TRUE) %>% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n```\n\n::: callout-note\n**Model Summary**\\\nAdjusted R-Squared of 0.470, indicating that approximately 47.0% of the variation in FDI total registered capital can be accounted for by the independent variables, adjusting for the number of predictors in the model.\n\n**ANOVA - Analysis of Variance (F test)**\\\nF-ratio of 7.219 -\\> is significant at p \\< 0.001. Hence, our regression model is statistically significant, suggesting that at least some of the PCI dimensions meaningfully contribute to predicting FDI total registered capital.\n\nThis model summary and ANOVA indicate that the model has strong predictive power for explaining FDI based on the given PCI dimensions. The significance of specific predictors, such as `Business Support Policy`, `Labor Policy`, and `Time Costs`, suggests that these are influential variables in explaining FDI total registered capital.\n:::\n:::\n\n::: callout-note\n### Summary of Findings\n\nFor the **total number of FDI projects**, the model has an **Adjusted R-Squared of 0.319**, indicating that approximately **31.9%** of the variation can be explained by the independent variables. The **ANOVA results show a significant F-ratio of 4.276 (p \\< 0.001)**, suggesting that some PCI dimensions significantly contribute to the model. However, not all predictors, such as Entry Costs and Transparency, had strong effects.\n\nIn contrast, the model for **total registered capital** has a higher **Adjusted R-Squared of 0.470**, indicating that **47.0%** of the variation is accounted for by the predictors. The **ANOVA shows a significant F-ratio of 7.219 (p \\< 0.001)**, confirming the model's strength. Key variables like Business Support Policy, Labor Policy, and Time Costs are particularly influential in explaining FDI total registered capital.\n:::\n\n<br>\n\n## 3.3 Run model to Select Independent variable\n\nI will now run different stepwise regression models to further investigate the specific positive and negative impacts of the independent variables on FDI.\n\nThis analysis will allow us to quantify how much a **1-unit increase** in each independent variable is expected to influence FDI, providing clearer insights into their contributions to both the total number of projects and total registered capital.\n\nAll of the model will be making use of the base model formulated from \\[4.2 Conduct Linear Regression\\]\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Forward Stepwise\n\n```{r}\npci_project_fw_mlr <- ols_step_forward_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_fw_mlr\n\nplot(pci_project_fw_mlr)\n```\n\n## Backward Stepwise\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_project_bw_mlr <- ols_step_backward_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_bw_mlr\n\nplot(pci_project_bw_mlr)\n```\n\n## Both\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_project_sb_mlr <- ols_step_both_p(\n  pci_project_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_project_sb_mlr\n\nplot(pci_project_sb_mlr)\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Forward Stepwise\n\n```{r}\npci_capital_fw_mlr <- ols_step_forward_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_fw_mlr\n\nplot(pci_capital_fw_mlr)\n```\n\n## Backward Stepwise\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_capital_bw_mlr <- ols_step_backward_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_bw_mlr\n\nplot(pci_capital_bw_mlr)\n```\n\n## Both\n\n```{r}\n# fig-width: 12\n# fig-height: 10\n\npci_capital_sb_mlr <- ols_step_both_p(\n  pci_capital_mlr, # this is the model\n  p_val = 0.05,\n  details = FALSE)\n\npci_capital_sb_mlr\n\nplot(pci_capital_sb_mlr)\n```\n:::\n:::\n\n<br>\n\n## 3.4 Model Selection\n\nNext, we will utilize a radar chart to visualize the performance of the different models.\n\nThe model that has the most edges touching the outer boundary is considered the best performer, indicating stronger overall results across the evaluated metrics.\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_metric <- compare_performance(pci_project_mlr,\n                              pci_project_fw_mlr$model,\n                              pci_project_bw_mlr$model,\n                              pci_project_sb_mlr$model)\n\nproject_metric$Name <- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", project_metric$Name)\n\n# plot radar\nplot(project_metric)\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_metric <- compare_performance(pci_capital_mlr,\n                              pci_capital_fw_mlr$model,\n                              pci_capital_bw_mlr$model,\n                              pci_capital_sb_mlr$model)\n\ncapital_metric$Name <- gsub(\".*\\\\\\\\([a-zA-Z0-9_]+)\\\\\\\\, \\\\\\\\model\\\\\\\\.*\", \"\\\\1\", capital_metric$Name)\n\n# plot radar\nplot(capital_metric)\n```\n:::\n\n::: callout-note\nFor predicting the total number of projects, the best-performing model is `pci_project_sb_mlr`).\n\nIn contrast, for predicting total registered capital, the best-performing model is `pci_capital_sb_mlr`.\n:::\n\n<br>\n\n## 3.5 Visualize model parameters\n\nWe will now utilize the best-performing model to quantify the exact positive or negative impact (in numerical terms) that a one-unit change in the independent variables will have.\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\n#| fig-height: 8\n#| fig-width: 12\n\nggcoefstats(pci_project_sb_mlr$model,\n            sort = \"ascending\")\n```\n\n## Total Registered Capital\n\n```{r}\n#| fig-height: 8\n#| fig-width: 12\n\nggcoefstats(pci_capital_sb_mlr$model,\n            sort = \"ascending\")\n```\n:::\n\n::: callout-note\nTo enhance the attraction of Foreign Direct Investment (FDI) projects and registered capital, policymakers should prioritize improvements in **Labor Policy** and **Business Support Policy**.\n\n-   For every single unit increase in **Labor Policy**, there is a positive influence on attracting more FDI projects and increasing registered capital.\n\n-   Similarly, an increase in **Business Support Policy** also contributes positively to both the total number of FDI projects and the registered capital.\n\nFocusing on these two policy areas will significantly bolster efforts to attract more FDI.\n:::\n\n<br>\n\n## 3.6 Checking for multicollinearity\n\nWe will now confirm our Correlation Matrix by looking at the **Variance Inflation Factor (VIF)**\n\n**Interpretation**\n\n-   \\< 5: low multicollinearity\n\n-   5-10: moderate multcollinearity\n\n-   \\>10: strong multicollinearity\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\ncheck_collinearity(pci_project_sb_mlr$model)\nplot(check_collinearity(pci_project_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, \n    hjust = 1\n  ))\n\n```\n\n## Total Registered Capital\n\n```{r}\ncheck_collinearity(pci_capital_sb_mlr$model)\nplot(check_collinearity(pci_capital_sb_mlr$model)) +\n  theme(axis.text.x = element_text(\n    angle = 45, \n    hjust = 1\n  ))\n\n```\n:::\n\n::: callout-note\nThere is no Multicollinearity found in both the model used for Total Number of projects and Total Registered Capital\n:::\n\n<br>\n\n## 3.7 Linearity Assumption Test\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_out <- plot(check_model(pci_project_sb_mlr$model,\n                        panel = FALSE))\nproject_out[[2]]\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_out <- plot(check_model(pci_capital_sb_mlr$model,\n                        panel = FALSE))\ncapital_out[[2]]\n```\n:::\n\n<br>\n\n## 3.8 Normality Assumption Test\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nplot(check_normality(pci_project_sb_mlr$model))\n```\n\n## Total Registered Capital\n\n```{r}\nplot(check_normality(pci_capital_sb_mlr$model))\n```\n:::\n\n<br>\n\n## 3.9 Checking of outliers\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\nproject_outliers <- check_outliers(pci_project_sb_mlr$model,\n                           method = \"cook\")\n\nproject_outliers\n\nplot(project_outliers <- check_outliers(pci_project_sb_mlr$model,\n                           method = \"cook\"))\n```\n\n## Total Registered Capital\n\n```{r}\ncapital_outliers <- check_outliers(pci_capital_sb_mlr$model,\n                           method = \"cook\")\n\ncapital_outliers\n\nplot(capital_outliers <- check_outliers(pci_capital_sb_mlr$model,\n                           method = \"cook\"))\n```\n:::\n\n::: callout-note\nAfter conducting the tests, I can conclude that both the models used for the Total Number of Projects and Total Registered Capital meet the necessary assumptions and successfully pass the tests.\n:::\n\n<br><br>\n\n# **4.0 Spatial Non-Stationary Assumption**\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Visualising spatial non-stationary\n\n```{r}\nproject_mlr_output <- as.data.frame(pci_project_sb_mlr$model$residuals) %>% \n  rename(`SB_MLR_RES` = `pci_project_sb_mlr$model$residuals`)\n\n# join the newly created data frame\nproject_fdi_sf <- cbind(provincial_boundaries, \n                        project_mlr_output$SB_MLR_RES) %>%\n  rename(`MLR_RES` = `project_mlr_output.SB_MLR_RES`)\n\ntmap_mode(\"view\")\n\ntm_shape(provincial_boundaries)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(project_fdi_sf) +  \n  tm_polygons(col = \"MLR_RES\",\n          alpha = 0.6,\n          size = 0.3,\n          style=\"quantile\") \n\ntmap_mode(\"plot\")\n```\n\n## Spatial stationary test\n\n```{r}\n# compute the distance-based weight matrix by using dnearneigh() function of spdep.\nproject_fdi_sf <- project_fdi_sf %>%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\n# global moran_perm \nglobal_moran_perm(project_fdi_sf$MLR_RES, \n                  project_fdi_sf$nb, \n                  project_fdi_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 999)\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Visualising spatial non-stationary\n\n```{r}\ncapital_mlr_output <- as.data.frame(pci_capital_sb_mlr$model$residuals) %>% \n  rename(`SB_MLR_RES` = `pci_capital_sb_mlr$model$residuals`)\n\n# join the newly created data frame\ncapital_fdi_sf <- cbind(provincial_boundaries, \n                        capital_mlr_output$SB_MLR_RES) %>%\n  rename(`MLR_RES` = `capital_mlr_output.SB_MLR_RES`)\n\ntmap_mode(\"view\")\n\ntm_shape(provincial_boundaries)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(capital_fdi_sf) +  \n  tm_polygons(col = \"MLR_RES\",\n          alpha = 0.6,\n          size = 0.3,\n          style=\"quantile\") \n\ntmap_mode(\"plot\")\n```\n\n## Spatial stationary test\n\n```{r}\n# compute the distance-based weight matrix by using dnearneigh() function of spdep.\ncapital_fdi_sf <- capital_fdi_sf %>%\n  mutate(nb = st_knn(geometry, k=6,\n                     longlat = FALSE),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before = 1)\n\n# global moran_perm \nglobal_moran_perm(capital_fdi_sf$MLR_RES, \n                  capital_fdi_sf$nb, \n                  capital_fdi_sf$wt, \n                  alternative = \"two.sided\", \n                  nsim = 999)\n```\n:::\n:::\n\n::: callout-note\nBased on the results of the Moran's I tests, I can conclude that there is no evidence of significant spatial autocorrelation in the data for either model. This suggests that the distribution of variable does not show systematic clustering or dispersion across the studied area.\n:::\n\n<br/><br/>\n\n# **5.0 Local**\n\n### Preparing the data\n\n```{r}\npci_2021 <- pci_2021 %>% \n  left_join(provincial_boundaries %>% \n              select(province_code, geometry), \n            by = \"province_code\") %>% \n  st_as_sf()\n```\n\n### Fixed VS Adaptive Bandwidth\n\n::: panel-tabset\n## Total Number of Projects\n\n::: panel-tabset\n## Fixed Bandwidth\n\n```{r}\nbw.fixed_project <- bw.gwr(formula = total_project_count ~ \n                             `Entry Costs` + `Land Access` + Transparency + \n                             `Time Costs` + `Informal charges` + Proactivity + \n                             `Business Support Policy` + `Labor Policy` +\n                             `Law & Order`,\n                           data=pci_2021,\n                           approach=\"CV\", \n                           kernel=\"boxcar\", \n                           adaptive=FALSE, \n                           longlat=FALSE)\n\ngwr.fixed_project <- gwr.basic(formula = total_project_count ~ \n                                 `Entry Costs` +  `Land Access` + Transparency + \n                                 `Time Costs` + `Informal charges` + Proactivity + \n                                 `Business Support Policy` + `Labor Policy` +\n                                 `Law & Order`,\n                               data=pci_2021,\n                               bw=bw.fixed_project, \n                               kernel = 'boxcar', \n                               longlat = FALSE)\n\ngwr.fixed_project\n```\n\n## Adaptive Bandwidth\n\n```{r}\nbw.adaptive_project <- bw.gwr(formula = total_project_count ~ \n                                `Entry Costs` + `Land Access` + Transparency + \n                                `Time Costs` + `Informal charges` + Proactivity +\n                                `Business Support Policy` + `Labor Policy` +\n                                `Law & Order`,\n                              data=pci_2021,\n                              approach=\"CV\", \n                              kernel=\"boxcar\", \n                              adaptive=TRUE, \n                              longlat=FALSE)\n\ngwr.adaptive_project <- gwr.basic(formula = total_project_count ~ \n                                    `Entry Costs` + `Land Access` + Transparency +\n                                    `Time Costs` + `Informal charges` + Proactivity + \n                                    `Business Support Policy` + `Labor Policy` +\n                                    `Law & Order`,\n                                  data=pci_2021,\n                                  bw=bw.adaptive_project,\n                                  kernel = 'boxcar',\n                                  adaptive=TRUE, \n                                  longlat = FALSE)\n\ngwr.adaptive_project\n```\n:::\n\n## Total Registered Capital\n\n::: panel-tabset\n## Fixed Bandwidth\n\n```{r}\nbw.fixed_capital <- bw.gwr(formula = total_registered_capital ~ \n                             `Entry Costs` + `Land Access` + Transparency + \n                             `Time Costs` + `Informal charges` + Proactivity + \n                             `Business Support Policy` + `Labor Policy` +\n                             `Law & Order`,\n                           data=pci_2021,\n                           approach=\"CV\", \n                           kernel=\"bisquare\", \n                           adaptive=FALSE, \n                           longlat=FALSE)\n\ngwr.fixed_capital <- gwr.basic(formula = total_registered_capital ~ \n                                 `Entry Costs` + `Land Access` + Transparency + \n                                 `Time Costs` + `Informal charges` + Proactivity + \n                                 `Business Support Policy` + `Labor Policy` +\n                                 `Law & Order`,\n                               data=pci_2021,\n                               bw=bw.fixed_capital, \n                               kernel = 'bisquare', \n                               longlat = FALSE)\n\ngwr.fixed_capital\n```\n\n## Adaptive Bandwidth\n\n```{r}\nbw.adaptive_capital <- bw.gwr(formula = total_registered_capital ~ \n                                `Entry Costs` + `Land Access` + Transparency + \n                                `Time Costs` + `Informal charges` + Proactivity +\n                                `Business Support Policy` + `Labor Policy` +\n                                `Law & Order`,\n                              data=pci_2021,\n                              approach=\"CV\", \n                              kernel=\"bisquare\", \n                              adaptive=TRUE, \n                              longlat=FALSE)\n\ngwr.adaptive_capital <- gwr.basic(formula = total_registered_capital ~ \n                                    `Entry Costs` + `Land Access` + Transparency + \n                                    `Time Costs` + `Informal charges` + Proactivity + \n                                    `Business Support Policy` + `Labor Policy` +\n                                    `Law & Order`,\n                                  data=pci_2021,\n                                  bw=bw.adaptive_capital, \n                                  kernel = 'bisquare',\n                                  adaptive=TRUE, \n                                  longlat = FALSE)\n\ngwr.adaptive_capital\n```\n:::\n:::\n\n<br/>\n\n### Visualising Local R2\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\n# Converting SDF into sf data.frame\npci_2021 <- st_as_sf(gwr.fixed_project$SDF) %>%\n  st_transform(crs=3405)\n\n\ngwr.fixed.output_project <- as.data.frame(gwr.fixed_project$SDF)\npci_2021.fixed_project <- cbind(pci_2021, as.matrix(gwr.fixed.output_project))\n\nglimpse(pci_2021.fixed_project)\n```\n\n```{r}\n# Set tmap options to check and fix any invalid polygons\ntmap_options(check.and.fix = TRUE)\n\ntmap_mode(\"view\")\n\nstr(pci_2021.fixed_project$Local_R2)\npci_2021.fixed_project$Local_R2 <- unlist(pci_2021.fixed_project$Local_R2)\n\n\ntm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.fixed_project) +  \n  tm_polygons(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n```\n\n## Total Registered Capital\n\n```{r}\n# Converting SDF into sf data.frame\npci_2021 <- st_as_sf(gwr.adaptive_capital$SDF) %>%\n  st_transform(crs=3405)\n\n\ngwr.adaptive.output_capital <- as.data.frame(gwr.adaptive_capital$SDF)\npci_2021.adaptive_capital <- cbind(pci_2021, as.matrix(gwr.adaptive.output_capital))\n\nglimpse(pci_2021.adaptive_capital)\n```\n\n```{r}\n# Set tmap options to check and fix any invalid polygons\ntmap_options(check.and.fix = TRUE)\n\ntmap_mode(\"view\")\n\nstr(pci_2021.adaptive_capital$Local_R2)\npci_2021.adaptive_capital$Local_R2 <- unlist(pci_2021.adaptive_capital$Local_R2)\n\n\ntm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.adaptive_capital) +  \n  tm_polygons(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n```\n:::\n\n<br>\n\n### Visualising coefficient estimates\n\n::: panel-tabset\n## Total Number of Projects\n\n```{r}\ntmap_mode(\"view\")\n\nAREA_SQM_SE <- tm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.fixed_project) +  \n  tm_polygons(col = \"Transparency_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n\nAREA_SQM_TV <- tm_shape(provincial_boundaries)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(pci_2021.adaptive_capital) +  \n  tm_polygons(col = \"Transparency_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(5,8))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n```\n\n## Total Registered Capital\n\n```{r}\n\n```\n:::\n\n<br><br>\n\n# **6.0 Shiny Storyboard**\n\n## 6.1 Global Explanatory Model\n\n### 6.1.1 Multiple Linear Regression (MLR)\n\nMultiple Linear Regression (MLR) provides a baseline model to predict an outcome using multiple predictor variables. It assumes a consistent, global relationship across all data points, offering a broad understanding of how these variables influence the dependent variable overall.\n\nUsers have the flexibility to select specific combinations of predictor variables (e.g., PCI factors) to explore different modeling outcomes and compare how these combinations affect results.\n\n**Interpretation**: A higher Adjusted R2 indicates that the model more effectively explains the variation in the outcome. Additionally, p-value reflects the statistical significance of the model, with lower values indicating stronger confidence in the predictors’ influence.\n\n![](images/clipboard-1002269832.png)\n\n<br>\n\n### 6.1.2 Stepwise Model Selection\n\n**Stepwise Model Selection** allows users to refine the Multiple Linear Regression model by adding or removing predictor variables in a systematic way.\n\nUsers can select from 3 approaches:\n\n-   **forward selection** (starting with no predictors and adding them),\n\n-   **backward elimination** (starting with all predictors and removing them),\n\n-   or **both** (a combination of adding and removing).\n\nUsers also have control over the **confidence level** (e.g., 0.95 or 0.99), adjusting the stringency for including predictors based on statistical significance.\n\n**Interpretation and Visualization**: A radar chart provides a visual comparison of different models, allowing users to select and view how models perform across chosen predictors and confidence levels. This helps in identifying the most effective model based on the desired balance of predictors and statistical robustness.\n\n![](images/clipboard-1995167839.png)\n\n<br>\n\n### 6.1.3 Visualise Model Parameters\n\n**Visualize Model Parameters** offers users an interactive way to examine and compare the effects of predictor variables across different stepwise models. Users can select their preferred model from the stepwise selection results and sort parameter values in ascending or descending order for easier comparison.\n\n**Interpretation and Customization**: This visualization provides a clear view of each predictor’s influence on the outcome variable within the selected model, helping users assess the relative importance of predictors. By sorting the parameters, users can quickly identify the most impactful variables or spot subtle differences across models, aiding in deeper analysis and model refinement.\n\n![](images/clipboard-1084091748.png)\n\n<br>\n\n## 6.2 Local Explanatory Model\n\n### 6.2.1 Bandwidth Selection\n\n**Bandwidth Selection** in Geographically Weighted Regression (GWR) allows users to fine-tune the model’s spatial sensitivity by choosing between **fixed** and **adaptive** bandwidth options.\n\n-   **Side-by-Side Comparison**:\\\n    Users can compare the effects of **fixed** vs. **adaptive** bandwidths side-by-side. This comparison highlights how each bandwidth type influences the spatial scale of the analysis:\n\n    -   **Fixed bandwidth** applies a constant spatial radius for all data points, which is ideal for evenly spaced data.\n\n    -   **Adaptive bandwidth** adjusts based on data density, using a larger bandwidth in sparse areas and a smaller one in dense areas, enhancing accuracy in regions with varying data distributions.\n\n-   **Selection Options for Each Bandwidth Type**:\n\n    -   **Approach**: Users can choose from **cross-validation** or **A/C corrected** methods to optimize the bandwidth.\n\n    -   **Kernel Method**: Users can select the **kernel type** (e.g., Gaussian, bisquare, or tricube) to define the shape and weighting of spatial influence around each data point, tailoring the model to the spatial structure of the data.\n\n**Purpose**:\\\nThis flexible bandwidth selection process allows users to determine the optimal balance of local vs. global influence, enhancing model accuracy and providing insights into spatial patterns at different scales.\n\n![](images/clipboard-4235001143.png)\n\n<br>\n\n### 6.2.2 Visualise Local R2\n\n**Visualizing Local** **R2** provides an in-depth look at how well the Geographically Weighted Regression (GWR) model explains variations in the outcome across different areas. This visualization highlights spatial differences in model performance, making it easier to identify regions where predictors more effectively capture local patterns.\n\n-   **Customization Options**:\n\n    -   **Bandwidth Type**: Choose between **fixed** or **adaptive** bandwidth to control the scale of spatial influence.\n\n    -   **Bandwidth Optimization Approach**: Select **cross-validation** or **A/C corrected** to determine the optimal bandwidth, allowing a focus on either predictive accuracy or model simplicity.\n\n    -   **Kernel Method**: Choose the kernel type (e.g., Gaussian, bisquare, or tricube) to set the shape and weighting of spatial influence, refining how local R2 values are calculated across locations.\n\n\\\nThis flexible visualization helps users assess where the model has strong or weak explanatory power across the study area, offering insights into local model fit. By adjusting bandwidth, approach, and kernel, users can explore how these choices impact model performance, identifying areas with robust predictions and areas needing further investigation.\n\n![](images/clipboard-2012200626.png)\n\n<br>\n\n## 6.5 Spatial Non-Stationary Assumption\n\nThe Spatial Non-Stationarity Assumption tool helps assess whether relationships between variables vary across different spatial locations. In this analysis, it tests whether the influence of **Provincial Competitiveness Index (PCI) dimensions** on **FDI metrics** (Total Number of Projects and Total Registered Capital) remains consistent across provinces or if it changes depending on regional characteristics.\n\n![](images/Spatial%20Non-Stationary%20Assumption.jpg)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"Take-home_Ex03.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"cosmo","title":"Take-home Exercise 3: Provincial Competitiveness Index influence on FDI in Vietnam","author":"kai feng","date":"Oct 15, 2024","date-modified":"last-modified"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}